<!DOCTYPE html>
<!-- saved from url=(0157)https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python | Jupyter notebooks – a Swiss Army Knife for Quants</title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://ipythonquant.wordpress.com/xmlrpc.php">

<meta name="robots" content="max-image-preview:large">
<meta name="google-site-verification" content="ut82iOH86wxZKfvPL9TxxNjunb0ppeDLJb96L6R4U8M">
<meta name="msvalidate.01" content="4CFA2028380831691D3477A82D860554">
<link rel="dns-prefetch" href="https://ced.sascdn.com/">
<link rel="dns-prefetch" href="https://s0.wp.com/">
<link rel="dns-prefetch" href="https://wordpress.com/">
<link rel="dns-prefetch" href="https://fonts-api.wp.com/">
<link rel="dns-prefetch" href="https://s.pubmine.com/">
<link rel="dns-prefetch" href="https://x.bidswitch.net/">
<link rel="dns-prefetch" href="https://static.criteo.net/">
<link rel="dns-prefetch" href="https://ib.adnxs.com/">
<link rel="dns-prefetch" href="https://aax.amazon-adsystem.com/">
<link rel="dns-prefetch" href="https://bidder.criteo.com/">
<link rel="dns-prefetch" href="https://cas.criteo.com/">
<link rel="dns-prefetch" href="https://gum.criteo.com/">
<link rel="dns-prefetch" href="https://ads.pubmatic.com/">
<link rel="dns-prefetch" href="https://gads.pubmatic.com/">
<link rel="dns-prefetch" href="https://tpc.googlesyndication.com/">
<link rel="dns-prefetch" href="https://ad.doubleclick.net/">
<link rel="dns-prefetch" href="https://googleads.g.doubleclick.net/">
<link rel="dns-prefetch" href="https://www.googletagservices.com/">
<link rel="dns-prefetch" href="https://cdn.switchadhub.com/">
<link rel="dns-prefetch" href="https://delivery.g.switchadhub.com/">
<link rel="dns-prefetch" href="https://delivery.swid.switchadhub.com/">
<link rel="dns-prefetch" href="https://a.teads.tv/">
<link rel="dns-prefetch" href="https://prebid.media.net/">
<link rel="dns-prefetch" href="https://adserver-us.adtech.advertising.com/">
<link rel="dns-prefetch" href="https://fastlane.rubiconproject.com/">
<link rel="dns-prefetch" href="https://prebid-server.rubiconproject.com/">
<link rel="dns-prefetch" href="https://hb-api.omnitagjs.com/">
<link rel="dns-prefetch" href="https://mtrx.go.sonobi.com/">
<link rel="dns-prefetch" href="https://apex.go.sonobi.com/">
<link rel="dns-prefetch" href="https://u.openx.net/">
<link href="https://fonts.gstatic.com/" crossorigin="" rel="preconnect">
<link rel="alternate" type="application/rss+xml" title="Jupyter notebooks - a Swiss Army Knife for Quants » Feed" href="https://ipythonquant.wordpress.com/feed/">
<link rel="alternate" type="application/rss+xml" title="Jupyter notebooks - a Swiss Army Knife for Quants » Comments Feed" href="https://ipythonquant.wordpress.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Jupyter notebooks - a Swiss Army Knife for Quants » Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python Comments Feed" href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/feed/">
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
	<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s0.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1677072837i&ver=6.3-alpha-56011"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){p.clearRect(0,0,i.width,i.height),p.fillText(e,0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(t,0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(p&&p.fillText)switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s("\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!s("\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!s("\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!s("\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udfff","\ud83e\udef1\ud83c\udffb\u200b\ud83e\udef2\ud83c\udfff")}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link crossorigin="anonymous" rel="stylesheet" id="all-css-0-1" href="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(1)" type="text/css" media="all">
<style id="wp-block-library-inline-css">
.has-text-align-justify {
	text-align:justify;
}
.wp-block-cover__image-background.has-parallax {
	background-size: cover;
}
</style>
<style id="global-styles-inline-css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-family--albert-sans: 'Albert Sans';--wp--preset--font-family--alegreya: Alegreya;--wp--preset--font-family--arvo: Arvo;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda';--wp--preset--font-family--cabin: Cabin;--wp--preset--font-family--chivo: Chivo;--wp--preset--font-family--commissioner: Commissioner;--wp--preset--font-family--cormorant: Cormorant;--wp--preset--font-family--courier-prime: 'Courier Prime';--wp--preset--font-family--crimson-pro: 'Crimson Pro';--wp--preset--font-family--dm-mono: 'DM Mono';--wp--preset--font-family--dm-sans: 'DM Sans';--wp--preset--font-family--domine: Domine;--wp--preset--font-family--eb-garamond: 'EB Garamond';--wp--preset--font-family--epilogue: Epilogue;--wp--preset--font-family--figtree: Figtree;--wp--preset--font-family--fira-sans: 'Fira Sans';--wp--preset--font-family--fraunces: Fraunces;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono';--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans';--wp--preset--font-family--inter: Inter;--wp--preset--font-family--josefin-sans: 'Josefin Sans';--wp--preset--font-family--jost: Jost;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville';--wp--preset--font-family--libre-franklin: 'Libre Franklin';--wp--preset--font-family--literata: Literata;--wp--preset--font-family--lora: Lora;--wp--preset--font-family--merriweather: Merriweather;--wp--preset--font-family--montserrat: Montserrat;--wp--preset--font-family--newsreader: Newsreader;--wp--preset--font-family--nunito: Nunito;--wp--preset--font-family--open-sans: 'Open Sans';--wp--preset--font-family--overpass: Overpass;--wp--preset--font-family--petrona: Petrona;--wp--preset--font-family--piazzolla: Piazzolla;--wp--preset--font-family--playfair-display: 'Playfair Display';--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans';--wp--preset--font-family--poppins: Poppins;--wp--preset--font-family--raleway: Raleway;--wp--preset--font-family--roboto-slab: 'Roboto Slab';--wp--preset--font-family--roboto: Roboto;--wp--preset--font-family--rubik: Rubik;--wp--preset--font-family--sora: Sora;--wp--preset--font-family--source-sans-pro: 'Source Sans Pro';--wp--preset--font-family--source-serif-pro: 'Source Serif Pro';--wp--preset--font-family--space-mono: 'Space Mono';--wp--preset--font-family--texturina: Texturina;--wp--preset--font-family--work-sans: 'Work Sans';--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-2-1" href="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(2)" type="text/css" media="all">
<link rel="stylesheet" id="penscratch-fonts-css" href="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/css" media="all">
<link crossorigin="anonymous" rel="stylesheet" id="all-css-4-1" href="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(3)" type="text/css" media="all">
<link crossorigin="anonymous" rel="stylesheet" id="print-css-5-1" href="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/global-print.css" type="text/css" media="print">
<style id="jetpack-global-styles-frontend-style-inline-css">
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-8-1" href="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(4)" type="text/css" media="all">
<script id="jetpack_related-posts-js-extra">
var related_posts_js_options = {"post_heading":"h4"};
</script>
<script id="wpcom-actionbar-placeholder-js-extra">
var actionbardata = {"siteID":"88621851","siteURL":"http:\/\/ipythonquant.wordpress.com","xhrURL":"https:\/\/ipythonquant.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"8c049a1351","isLoggedIn":"","statusMessage":"","subsEmailDefault":"instantly","proxyScriptUrl":"https:\/\/s0.wp.com\/wp-content\/js\/wpcom-proxy-request.js?ver=20211021","shortlink":"https:\/\/wp.me\/p5ZQAH-8k","i18n":{"followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar"}};
</script>
<script crossorigin="anonymous" type="text/javascript" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(5)"></script>
<script type="text/javascript">
	window.addEventListener( 'DOMContentLoaded', function() {
		rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
	} );
</script>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-0-2" href="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/style.css" type="text/css" media="all">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://ipythonquant.wordpress.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s0.wp.com/wp-includes/wlwmanifest.xml">
<meta name="generator" content="WordPress.com">
<link rel="canonical" href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/">
<link rel="shortlink" href="https://wp.me/p5ZQAH-8k">
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fipythonquant.wordpress.com%2F2018%2F11%2F18%2Ffast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python%2F&amp;for=wpcom-auto-discovery"><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fipythonquant.wordpress.com%2F2018%2F11%2F18%2Ffast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python%2F&amp;for=wpcom-auto-discovery">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python">
<meta property="og:url" content="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/">
<meta property="og:description" content="In this tutorial we will see how to speed up Monte-Carlo Simulation with GPU and Cloud Computing in Python using PyTorch and Google Cloud Platform. Motivated from my experience developing a RNN for…">
<meta property="article:published_time" content="2018-11-18T10:52:16+00:00">
<meta property="article:modified_time" content="2018-11-18T15:37:39+00:00">
<meta property="og:site_name" content="Jupyter notebooks - a Swiss Army Knife for Quants">
<meta property="og:image" content="https://ipythonquant.files.wordpress.com/2018/11/gamma_plot.png?w=1200">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="706">
<meta property="og:image:alt" content="">
<meta property="og:locale" content="en_US">
<meta property="fb:app_id" content="249643311490">
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom">
<meta name="twitter:text:title" content="Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python">
<meta name="twitter:image" content="https://ipythonquant.files.wordpress.com/2018/11/gamma_plot.png?w=640">
<meta name="twitter:card" content="summary_large_image">

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://s0.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48">
<link rel="icon" type="image/x-icon" href="https://s0.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48">
<link rel="apple-touch-icon" href="https://s0.wp.com/i/webclip.png">
<link rel="openid.server" href="https://ipythonquant.wordpress.com/?openidserver=1">
<link rel="openid.delegate" href="https://ipythonquant.wordpress.com/">
<link rel="search" type="application/opensearchdescription+xml" href="https://ipythonquant.wordpress.com/osd.xml" title="Jupyter notebooks - a Swiss Army Knife for Quants">
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com">
<meta name="theme-color" content="#eeeeee">
		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="application-name" content="Jupyter notebooks - a Swiss Army Knife for Quants"><meta name="msapplication-window" content="width=device-width;height=device-height"><meta name="msapplication-tooltip" content="A blog about quantitative finance, data science in fraud detection, machine and deep learning by Matthias Groncki"><meta name="msapplication-task" content="name=Subscribe;action-uri=https://ipythonquant.wordpress.com/feed/;icon-uri=https://s0.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s0.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s0.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s0.wp.com/i/favicon.ico"><meta name="description" content="In this tutorial we will see how to speed up Monte-Carlo Simulation with GPU and Cloud Computing in Python using PyTorch and Google Cloud Platform. Motivated from my experience developing a RNN for anomaly detection in PyTorch I wanted to port the option pricing code from my previous posts from TensorFlow to PyTorch. PyTorch offers…">

			<style>
			.wordads-ad-wrapper {
				display:none;
				font: normal 11px Arial, sans-serif;
				letter-spacing: 1px;
				text-decoration: none;
				width: 100%;
				margin: 25px auto;
				padding: 0;
			}
			.wordads-ad-title {
				margin-bottom: 5px;
			}
			.wordads-ad-controls {
				margin-top: 5px;
				text-align: right;
			}
			.wordads-ad-controls span {
				cursor: pointer;
			}
			.wordads-ad {
				width: fit-content;
				margin: 0 auto;
			}
			</style>
					<script type="text/javascript">
				var wa_smart = { 'network_id': 3905, 'site_id': 474853, 'page_id': 1572546, 'formats': [ { 'id': 110354, 'tagId': 'sas_110354' } ], 'blog_id': 88621851, 'target': 'iab_category=IAB19;iab_category=IAB13;wp_blog_id=88621851;language=en', 'inline': { 'title': 'Advertisement', 'gdpr': '<span onclick="__tcfapi( \'showUi\' )">Privacy Settings</span>', 'format_id': 110354, 'max_slots': 20, 'max_blaze_slots': 1, 'enabled': true } };
				wa_smart.cmd = [];
				
				var sas = sas || {};
				sas.cmd = sas.cmd || [];
			</script>		<script type="text/javascript">
		function __ATA_CC() {var v = document.cookie.match('(^|;) ?personalized-ads-consent=([^;]*)(;|$)');return v ? 1 : 0;}
		var __ATA_PP = { 'pt': 1, 'ht': 0, 'tn': 'penscratch', 'uloggedin': 0, 'amp': false, 'consent': __ATA_CC(), 'gdpr_applies': true, 'ad': { 'label': { 'text': 'Advertisements' }, 'reportAd': { 'text': 'Report this ad' }, 'privacySettings': { 'text': 'Privacy', 'onClick': function() { window.__tcfapi && window.__tcfapi( 'showUi' ) } } }, 'disabled_slot_formats': [ 'IAD' ], 'siteid': 8982, 'blogid': 88621851, 'js_hint': 'tcf2_test', 'afp_ad_client': 'pub-4388288814859685' };
		var __ATA = __ATA || {};
		__ATA.cmd = __ATA.cmd || [];
		__ATA.criteo = __ATA.criteo || {};
		__ATA.criteo.cmd = __ATA.criteo.cmd || [];
		</script>
		<script type="text/javascript">
		(function(){var g=Date.now||function(){return+new Date};function h(a,b){a:{for(var c=a.length,d="string"==typeof a?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:"string"==typeof a?a.charAt(b):a[b]};function k(a,b,c){c=null!=c?"="+encodeURIComponent(String(c)):"";if(b+=c){c=a.indexOf("#");0>c&&(c=a.length);var d=a.indexOf("?");if(0>d||d>c){d=c;var e=""}else e=a.substring(d+1,c);a=[a.substr(0,d),e,a.substr(c)];c=a[1];a[1]=b?c?c+"&"+b:b:c;a=a[0]+(a[1]?"?"+a[1]:"")+a[2]}return a};var l=0;function m(a,b){var c=document.createElement("script");c.src=a;c.onload=function(){b&&b(void 0)};c.onerror=function(){b&&b("error")};a=document.getElementsByTagName("head");var d;a&&0!==a.length?d=a[0]:d=document.documentElement;d.appendChild(c)}function n(a){var b=void 0===b?document.cookie:b;return(b=h(b.split("; "),function(c){return-1!=c.indexOf(a+"=")}))?b.split("=")[1]:""}function p(a){return"string"==typeof a&&0<a.length}
		function r(a,b,c){b=void 0===b?"":b;c=void 0===c?".":c;var d=[];Object.keys(a).forEach(function(e){var f=a[e],q=typeof f;"object"==q&&null!=f||"function"==q?d.push(r(f,b+e+c)):null!==f&&void 0!==f&&(e=encodeURIComponent(b+e),d.push(e+"="+encodeURIComponent(f)))});return d.filter(p).join("&")}function t(a,b){a||((window.__ATA||{}).config=b.c,m(b.url))}var u=Math.floor(1E13*Math.random()),v=window.__ATA||{};window.__ATA=v;window.__ATA.cmd=v.cmd||[];v.rid=u;v.createdAt=g();var w=window.__ATA||{},x="s.pubmine.com";
		w&&w.serverDomain&&(x=w.serverDomain);var y="//"+x+"/conf",z=window.top===window,A=window.__ATA_PP&&window.__ATA_PP.gdpr_applies,B="boolean"===typeof A?Number(A):null,C=window.__ATA_PP||null,D=z?document.referrer?document.referrer:null:null,E=z?window.location.href:document.referrer?document.referrer:null,F,G=n("__ATA_tuuid");F=G?G:null;var H=window.innerWidth+"x"+window.innerHeight,I=n("usprivacy"),J=r({gdpr:B,pp:C,rid:u,src:D,ref:E,tuuid:F,vp:H,us_privacy:I?I:null},"",".");
		(function(a){var b=void 0===b?"cb":b;l++;var c="callback__"+g().toString(36)+"_"+l.toString(36);a=k(a,b,c);window[c]=function(d){t(void 0,d)};m(a,function(d){d&&t(d)})})(y+"?"+J);}).call(this);
		</script><script src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/conf"></script>	<script>
		var sas_fallback = sas_fallback || [];
		sas_fallback.push(
			{ tag: "&lt;div id=&quot;atatags-26942-64b4d6873b30a&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-26942-64b4d6873b30a\',location: 120,formFactor: \'001\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',onClick: function() { window.__tcfapi &amp;&amp; window.__tcfapi( \'showUi\' ); },}}});});&lt;/script&gt;", type: 'belowpost' },
			{ tag: "&lt;div id=&quot;atatags-26942-{{unique_id}}&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-26942-{{unique_id}}\',location: 310,formFactor: \'001\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',onClick: function() { window.__tcfapi &amp;&amp; window.__tcfapi( \'showUi\' ); },}}});});&lt;/script&gt;", type: 'inline' }
		);
	</script>		<script type="text/javascript">

			window.doNotSellCallback = function() {

				var linkElements = [
					'a[href="https://wordpress.com/?ref=footer_blog"]',
					'a[href="https://wordpress.com/?ref=footer_website"]',
					'a[href="https://wordpress.com/?ref=vertical_footer"]',
					'a[href^="https://wordpress.com/?ref=footer_segment_"]',
				].join(',');

				var dnsLink = document.createElement( 'a' );
				dnsLink.href = 'https://wordpress.com/advertising-program-optout/';
				dnsLink.classList.add( 'do-not-sell-link' );
				dnsLink.rel = 'nofollow';
				dnsLink.style.marginLeft = '0.5em';
				dnsLink.textContent = 'Do Not Sell or Share My Personal Information';

				var creditLinks = document.querySelectorAll( linkElements );

				if ( 0 === creditLinks.length ) {
					return false;
				}

				Array.prototype.forEach.call( creditLinks, function( el ) {
					el.insertAdjacentElement( 'afterend', dnsLink );
				});

				return true;
			};

		</script>
		<script id="cmp-configuration" type="application/configuration">{"gvlVersion":"206","consentLanguage":"EN","locale":"en","vendorsAll":"BMhq_4__7a_t_j_f_T9ujzGr_v8ffdyGIML5Nn3Au5d63xOC_ewnZou_VtXBUyPAl27IJChto5s6ias2LVEiteY9jUmzlKZpRPwMkg5iL2zrAQvN83NsbyBTPP9P7u7_Oyf_v7t_2_ue-_uu9-7vr_3-vx8br3P_o_9_76L7f35D_v_f3_l_n_v9cm37yev_________3_____-A","vendorsLegInterest":"BMgAkw1LiALsiBkJtAwihRAjCsICKBQAAACQNEBAC4MCnRGATawGQAoRQBHBACGAFGRAIAABIAkIgAkCLBAABAIBAACABAIBAAwMAA4ALQQCAAEB0DFMKABQLCBIgIiFMCEqBIICWyoQSgukFcIAqywIoBEbBQAIgkBFYAAgLFwDBEgJWJBAl1BtAAAQAIBRKhWIpPzQEKCZstUA","ajaxNonce":"49f3ecb65b","modulePath":"https:\/\/s0.wp.com\/wp-content\/blog-plugins\/wordads-classes\/js\/","gvlPath":"https:\/\/public-api.wordpress.com\/wpcom\/v2\/sites\/88621851\/cmp\/vendors\/en\/","_":{"title":"Privacy & Cookies","intro":"We, WordPress.com, and our advertising partners store and\/or access information on your device and also process personal data, like unique identifiers, browsing activity, and other standard information sent by your device including your IP address. This information is collected over time and used for personalised ads, ad measurement, audience insights, and product development specific to our ads program. If this sounds good to you, select \"I Agree!\" below.  Otherwise, you can get more information, customize your consent preferences, or decline consent by selecting \"Learn More\". Note that your preferences apply to all websites in the <a href=\"https:\/\/automattic.com\/cookies\/#user-ads-consent\" target=\"_blank\">WordPress.com network<\/a>, and if you change your mind in the future you can update your preferences anytime by visiting the Privacy link displayed under each ad. One last thing, our partners may process some of your data based on legitimate interests instead of consent but you can object to that by choosing \"Learn More\" and then disabling the Legitimate Interests toggle under any listed Purpose or Partner.","config":"Learn More","accept":"I Agree!","viewPartners":"View Partners","error":"We're sorry but an unexpected error occurred. Please try again later."}}</script><script type="text/javascript">
	window.google_analytics_uacct = "UA-52447-2";
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_gat._anonymizeIp']);
	_gaq.push(['_setDomainName', 'wordpress.com']);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script><script type="text/javascript" async="" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/ga.js"></script>
<link rel="stylesheet" type="text/css" href="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/shCore.css"><link rel="stylesheet" type="text/css" href="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/shThemeDefault.css"><link rel="stylesheet" type="text/css" id="gravatar-card-css" href="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/hovercard.min.css"><script src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/ata.js"></script><script src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/tag.js"></script><link href="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/actionbar.css" type="text/css" rel="stylesheet"><script charset="utf-8" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/3.js"></script></head>

<body class="post-template-default single single-post postid-516 single-format-standard customizer-styles-applied highlander-enabled highlander-light">
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/#content">Skip to content</a>
	<header id="masthead" class="site-header" role="banner">
		<div class="site-branding">
			<a href="https://ipythonquant.wordpress.com/" class="site-logo-link" rel="home" itemprop="url"></a>			<h1 class="site-title"><a href="https://ipythonquant.wordpress.com/" rel="home">Jupyter notebooks – a Swiss Army Knife for Quants</a></h1>
			<h2 class="site-description">A blog about quantitative finance, data science in fraud detection, machine and deep learning by Matthias Groncki</h2>
		</div>

		<nav id="site-navigation" class="main-navigation" role="navigation">
			<button class="menu-toggle">Menu</button>
			<div class="menu"><ul class=" nav-menu">
<li><a href="https://ipythonquant.wordpress.com/">Home</a></li><li class="page_item page-item-5"><a href="https://ipythonquant.wordpress.com/about-me/">About me</a></li>
<li class="page_item page-item-511"><a href="https://ipythonquant.wordpress.com/disclaimer/">Disclaimer</a></li>
<li class="page_item page-item-112"><a href="https://ipythonquant.wordpress.com/downloads-2/">Downloads</a></li>
<li class="page_item page-item-105"><a href="https://ipythonquant.wordpress.com/links/">Links</a></li>
</ul></div>
		</nav><!-- #site-navigation -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">
					<a href="https://ipythonquant.wordpress.com/" rel="home">
				<img class="custom-header" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/city1.jpg" width="937" height="300" alt="" scale="0">
			</a>
		
	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-516" class="post-516 post type-post status-publish format-standard has-post-thumbnail hentry category-allgemein">
	<header class="entry-header">
		<h1 class="entry-title">Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in&nbsp;Python</h1>
		<div class="entry-meta">
						<span class="posted-on"><a href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/" rel="bookmark"><time class="entry-date published" datetime="2018-11-18T12:52:16+02:00">18/11/2018</time><time class="updated" datetime="2018-11-18T17:37:39+02:00">18/11/2018</time></a></span><span class="byline"><span class="sep"> ~ </span><span class="author vcard"><a class="url fn n" href="https://ipythonquant.wordpress.com/author/mgroncki/">Matthias Groncki</a></span></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

	<div class="entry-content">
		<p>In this tutorial we will see how to speed up Monte-Carlo Simulation with GPU and Cloud Computing in Python using PyTorch and Google Cloud Platform. Motivated from my experience developing a RNN for anomaly detection in PyTorch I wanted to port the option pricing code from my previous posts from TensorFlow to PyTorch. PyTorch offers similar to TensorFlow auto-gradients, also known as algorithmic differentiation, but the programming style is quite different to TensorFlow. We will see how easy it is to run our code on a GPU with PyTorch. The calculation of a NPV and all first order Greeks of a simple Down-and-Out Option is 45 times faster (7.3 s vs. 160ms) on a Nvidia K80 compared to a calculation on the CPU of my MacBook Pro 15 from 2016 with a 2.6 GHz i7 and 16 GB Ram.</p>
<ul>
<li><strong>Update 1</strong> <em>The purpose of this example is to illustrate how to use Algorithmic Differentiation and GPU Computing with PyTorch in Python. There are more appropriate pricing models and methods for Barrier Options. This is a very naive approach in Black Scholes setting without taking any volatility smile into account.</em></li>
</ul>
<p>The notebooks are available on GitHub <a href="https://github.com/mgroncki/IPythonScripts/PricingPyTorch" rel="nofollow">https://github.com/mgroncki/IPythonScripts/PricingPyTorch</a></p>
<p>First we will look into analytical pricing of plain vanilla options and compare a pure Numpy versus a PyTorch and the previous TensorFlow implementation before we implement the Monte-Carlo Simulation in PyTorch.</p>
<h2>Analytical Plain Vanilla Pricing</h2>
<p>Lets start with plain vanilla call option in a Black Scholes World.</p>
<p>Maturtiy: 1 year<br>
Spot : 100<br>
Strike : 101<br>
Volatility: 30.0 %<br>
Risk free rate: 1.0 %</p>
<h3>Numpy Implementation</h3>
<p>We are using the same implementation as in the TensorFlow notebook</p>
<div><div id="highlighter_657817" class="syntaxhighlighter  python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments">## Plain Vanilla Call in TensorFlow</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="python keyword">def</code> <code class="python plain">blackScholes_py(S_0, strike, time_to_expiry, implied_vol, riskfree_rate):</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">S </code><code class="python keyword">=</code> <code class="python plain">S_0</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">K </code><code class="python keyword">=</code> <code class="python plain">strike</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt </code><code class="python keyword">=</code> <code class="python plain">time_to_expiry</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sigma </code><code class="python keyword">=</code> <code class="python plain">implied_vol</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r </code><code class="python keyword">=</code> <code class="python plain">riskfree_rate</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">Phi </code><code class="python keyword">=</code> <code class="python plain">stats.norm.cdf</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">d_1 </code><code class="python keyword">=</code> <code class="python plain">(np.log(S_0 </code><code class="python keyword">/</code> <code class="python plain">K) </code><code class="python keyword">+</code> <code class="python plain">(r</code><code class="python keyword">+</code><code class="python plain">sigma</code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python value">2</code><code class="python keyword">/</code><code class="python value">2</code><code class="python plain">)</code><code class="python keyword">*</code><code class="python plain">dt) </code><code class="python keyword">/</code> <code class="python plain">(sigma</code><code class="python keyword">*</code><code class="python plain">np.sqrt(dt))</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">d_2 </code><code class="python keyword">=</code> <code class="python plain">d_1 </code><code class="python keyword">-</code> <code class="python plain">sigma</code><code class="python keyword">*</code><code class="python plain">np.sqrt(dt)</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">S</code><code class="python keyword">*</code><code class="python plain">Phi(d_1) </code><code class="python keyword">-</code> <code class="python plain">K</code><code class="python keyword">*</code><code class="python plain">np.exp(</code><code class="python keyword">-</code><code class="python plain">r</code><code class="python keyword">*</code><code class="python plain">dt)</code><code class="python keyword">*</code><code class="python plain">Phi(d_2)</code></div></div></td></tr></tbody></table></div></div>
<p><img data-attachment-id="522" data-permalink="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/screenshot-2018-11-18-at-16-38-38/" data-orig-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-38-38.png" data-orig-size="1544,392" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screenshot 2018-11-18 at 16.38.38" data-image-description="" data-image-caption="" data-medium-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-38-38.png?w=300" data-large-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-38-38.png?w=656" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/screenshot-2018-11-18-at-16-38-38.png" alt="Screenshot 2018-11-18 at 16.38.38" class="alignnone size-full wp-image-522" srcset="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-38-38.png?w=656 656w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-38-38.png?w=1312 1312w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-38-38.png?w=150 150w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-38-38.png?w=300 300w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-38-38.png?w=768 768w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-38-38.png?w=1024 1024w" sizes="(max-width: 656px) 100vw, 656px"></p>
<div class="wordads-ad-wrapper" style="display: inherit;"><div id="atatags-26942-422605" data-adtags-width="655" style="display:block;height:272px;margin:0 auto;overflow:hidden;padding:0;width:300px;"><div style="font:10px &#39;Open Sans&#39;, Arial, sans-serif;height:12px;margin:0;padding:0;text-align:left;">Advertisements</div><div style="height:250px;width:300px;" class="ata-slot-container-wrapper">
                <div style="height:100%;width:100%;" class="ata-slot-container">
                    <div style="height:100%;margin:0;overflow:hidden;padding:0;position:relative;width:100%;" class="ata-frame-wrapper">
            <div class="user-feedback" style="position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden;background:#f1f1f1;white-space:nowrap;font-family:Helvetica, Arial, sans-serif;font-size:12px;line-height:12px;box-shadow:0px 1px 2px 0px inset #999;margin:0;display:none;table-layout:fixed;letter-spacing:0.2px;z-index:5000;padding:0;">
                <div style="color:#808080;font-size:10px;line-height:10px;text-align:center;margin:0;padding:0;position:absolute;top:4px;width:100%;">Powered by wordads.co</div>
                <div style="box-sizing:border-box;padding:5px;text-align:center;display:table-cell;vertical-align:middle;margin:0;width:100%;">
                    <div style="color:#404040;margin:8px 0 0 0;white-space:normal;display:none;text-align:center;padding:0;line-height:12px;" class="user-feedback__thank-message">
                        <div style="font-weight:bold;text-align:center;line-height:12px;">We've received your report.</div>
                        <br>
                        Thanks for your feedback!
                    </div>
                    <a class="user-feedback__reason" data-reason-id="1" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Seen too often</span>
                </div>
            </a><a class="user-feedback__reason" data-reason-id="2" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Not relevant</span>
                </div>
            </a><a class="user-feedback__reason" data-reason-id="3" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Offensive</span>
                </div>
            </a><a class="user-feedback__reason" data-reason-id="4" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Broken</span>
                </div>
            </a>
                </div>
                
            </div>
        
                        <iframe id="atatags-26942-422605_iframe" frameborder="0" scrolling="no" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(11).html" style="border:none;height:250px;margin:0;overflow:hidden;width:300px;" class="ata-frame"></iframe>
                    </div>
                </div>
            </div><div id="atatags-26942-422605__controls" class="ata-controls" style="height:10px;line-height:10px;margin:0;padding:0;text-align:right;width:300px;"><span id="atatags-26942-422605__complain-btn" class="ata-controls__complain-btn" style="color:#c8c7cc;cursor:pointer;font-family:Verdana, sans-serif;font-size:6px;letter-spacing:0.3px;text-transform:uppercase;vertical-align:middle;float:right;">Report this ad</span><span id="atatags-26942-422605__privacy-btn" class="ata-controls__privacy-btn" style="color:#c8c7cc;cursor:pointer;font-family:Verdana, sans-serif;font-size:6px;letter-spacing:0.3px;text-transform:uppercase;vertical-align:middle;float:left;">Privacy</span></div></div><script>__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: 'atatags-26942-422605',location: 310,formFactor: '001',label: {text: 'Advertisements',},creative: {reportAd: {text: 'Report this ad',},privacySettings: {text: 'Privacy',onClick: function() { window.__tcfapi && window.__tcfapi( 'showUi' ); },}}});});</script></div><p>And as expected its super fast. No surprises here. Next we will implement the same formula in PyTorch.</p>
<h3>PyTorch Implementation</h3>
<p>There are only minimal code changes compared to the numpy version required. In the actual pricing function we just need to replace <code>np</code> with <code>torch</code> and exchange the cdf function to use the PyTorch one and we have to convert our input into <code>torch.tensor</code>.</p>
<div><div id="highlighter_36726" class="syntaxhighlighter  python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">def</code> <code class="python plain">blackScholes_pyTorch(S_0, strike, time_to_expiry, implied_vol, riskfree_rate):</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">S </code><code class="python keyword">=</code> <code class="python plain">S_0</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">K </code><code class="python keyword">=</code> <code class="python plain">strike</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt </code><code class="python keyword">=</code> <code class="python plain">time_to_expiry</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sigma </code><code class="python keyword">=</code> <code class="python plain">implied_vol</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r </code><code class="python keyword">=</code> <code class="python plain">riskfree_rate</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">Phi </code><code class="python keyword">=</code> <code class="python plain">torch.distributions.Normal(</code><code class="python value">0</code><code class="python plain">,</code><code class="python value">1</code><code class="python plain">).cdf</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">d_1 </code><code class="python keyword">=</code> <code class="python plain">(torch.log(S_0 </code><code class="python keyword">/</code> <code class="python plain">K) </code><code class="python keyword">+</code> <code class="python plain">(r</code><code class="python keyword">+</code><code class="python plain">sigma</code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python value">2</code><code class="python keyword">/</code><code class="python value">2</code><code class="python plain">)</code><code class="python keyword">*</code><code class="python plain">dt) </code><code class="python keyword">/</code> <code class="python plain">(sigma</code><code class="python keyword">*</code><code class="python plain">torch.sqrt(dt))</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">d_2 </code><code class="python keyword">=</code> <code class="python plain">d_1 </code><code class="python keyword">-</code> <code class="python plain">sigma</code><code class="python keyword">*</code><code class="python plain">torch.sqrt(dt)</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">S</code><code class="python keyword">*</code><code class="python plain">Phi(d_1) </code><code class="python keyword">-</code> <code class="python plain">K</code><code class="python keyword">*</code><code class="python plain">torch.exp(</code><code class="python keyword">-</code><code class="python plain">r</code><code class="python keyword">*</code><code class="python plain">dt)</code><code class="python keyword">*</code><code class="python plain">Phi(d_2)</code></div></div></td></tr></tbody></table></div></div>
<p><img data-attachment-id="523" data-permalink="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/screenshot-2018-11-18-at-16-41-06/" data-orig-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-41-06.png" data-orig-size="1314,312" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screenshot 2018-11-18 at 16.41.06" data-image-description="" data-image-caption="" data-medium-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-41-06.png?w=300" data-large-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-41-06.png?w=656" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/screenshot-2018-11-18-at-16-41-06.png" alt="Screenshot 2018-11-18 at 16.41.06" class="alignnone size-full wp-image-523" srcset="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-41-06.png?w=656 656w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-41-06.png?w=1312 1312w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-41-06.png?w=150 150w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-41-06.png?w=300 300w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-41-06.png?w=768 768w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-41-06.png?w=1024 1024w" sizes="(max-width: 656px) 100vw, 656px"></p>
<p>We see now significant speed difference between Numpy or PyTorch.</p>
<p>Seems the PyTorch version is even faster as the pure numpy version. How can we use the auto-grad function in PyTorch to get the greeks?</p>
<h4>Greeks in PyTorch</h4>
<p>We just need to call the <code>.backward()</code> operator of the tensor which stores the prices and we can access the greeks with the <code>.grad</code> properity.</p>
<div><div id="highlighter_665504" class="syntaxhighlighter  python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">%</code><code class="python keyword">%</code><code class="python plain">timeit</code></div><div class="line number2 index1 alt1"><code class="python plain">S_0 </code><code class="python keyword">=</code> <code class="python plain">torch.tensor([</code><code class="python value">100.</code><code class="python plain">],requires_grad</code><code class="python keyword">=</code><code class="python color1">True</code><code class="python plain">)</code></div><div class="line number3 index2 alt2"><code class="python plain">K </code><code class="python keyword">=</code> <code class="python plain">torch.tensor([</code><code class="python value">101.</code><code class="python plain">],requires_grad</code><code class="python keyword">=</code><code class="python color1">True</code><code class="python plain">)</code></div><div class="line number4 index3 alt1"><code class="python plain">T </code><code class="python keyword">=</code> <code class="python plain">torch.tensor([</code><code class="python value">1.</code><code class="python plain">],requires_grad</code><code class="python keyword">=</code><code class="python color1">True</code><code class="python plain">)</code></div><div class="line number5 index4 alt2"><code class="python plain">sigma </code><code class="python keyword">=</code> <code class="python plain">torch.tensor([</code><code class="python value">0.3</code><code class="python plain">],requires_grad</code><code class="python keyword">=</code><code class="python color1">True</code><code class="python plain">)</code></div><div class="line number6 index5 alt1"><code class="python plain">r </code><code class="python keyword">=</code> <code class="python plain">torch.tensor([</code><code class="python value">0.01</code><code class="python plain">],requires_grad</code><code class="python keyword">=</code><code class="python color1">True</code><code class="python plain">)</code></div><div class="line number7 index6 alt2"><code class="python plain">npv_pytorch </code><code class="python keyword">=</code> <code class="python plain">blackScholes_pyTorch(S_0, K, T, sigma, r)</code></div><div class="line number8 index7 alt1"><code class="python plain">npv_pytorch.backward()</code></div></div></td></tr></tbody></table></div></div>
<p>639 µs ± 9.85 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)</p>
<div class="wordads-ad-wrapper" style="display: inherit;"><div id="atatags-26942-704198" data-adtags-width="655" style="display:block;height:272px;margin:0 auto;overflow:hidden;padding:0;width:300px;"><div style="font:10px &#39;Open Sans&#39;, Arial, sans-serif;height:12px;margin:0;padding:0;text-align:left;">Advertisements</div><div style="height:250px;width:300px;" class="ata-slot-container-wrapper">
                <div style="height:100%;width:100%;" class="ata-slot-container">
                    <div style="height:100%;margin:0;overflow:hidden;padding:0;position:relative;width:100%;" class="ata-frame-wrapper">
            <div class="user-feedback" style="position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden;background:#f1f1f1;white-space:nowrap;font-family:Helvetica, Arial, sans-serif;font-size:12px;line-height:12px;box-shadow:0px 1px 2px 0px inset #999;margin:0;display:none;table-layout:fixed;letter-spacing:0.2px;z-index:5000;padding:0;">
                <div style="color:#808080;font-size:10px;line-height:10px;text-align:center;margin:0;padding:0;position:absolute;top:4px;width:100%;">Powered by wordads.co</div>
                <div style="box-sizing:border-box;padding:5px;text-align:center;display:table-cell;vertical-align:middle;margin:0;width:100%;">
                    <div style="color:#404040;margin:8px 0 0 0;white-space:normal;display:none;text-align:center;padding:0;line-height:12px;" class="user-feedback__thank-message">
                        <div style="font-weight:bold;text-align:center;line-height:12px;">We've received your report.</div>
                        <br>
                        Thanks for your feedback!
                    </div>
                    <a class="user-feedback__reason" data-reason-id="1" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Seen too often</span>
                </div>
            </a><a class="user-feedback__reason" data-reason-id="2" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Not relevant</span>
                </div>
            </a><a class="user-feedback__reason" data-reason-id="3" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Offensive</span>
                </div>
            </a><a class="user-feedback__reason" data-reason-id="4" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Broken</span>
                </div>
            </a>
                </div>
                
            </div>
        
                        <iframe id="atatags-26942-704198_iframe" frameborder="0" scrolling="no" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(12).html" style="border:none;height:250px;margin:0;overflow:hidden;width:300px;" class="ata-frame"></iframe>
                    </div>
                </div>
            </div><div id="atatags-26942-704198__controls" class="ata-controls" style="height:10px;line-height:10px;margin:0;padding:0;text-align:right;width:300px;"><span id="atatags-26942-704198__complain-btn" class="ata-controls__complain-btn" style="color:#c8c7cc;cursor:pointer;font-family:Verdana, sans-serif;font-size:6px;letter-spacing:0.3px;text-transform:uppercase;vertical-align:middle;float:right;">Report this ad</span><span id="atatags-26942-704198__privacy-btn" class="ata-controls__privacy-btn" style="color:#c8c7cc;cursor:pointer;font-family:Verdana, sans-serif;font-size:6px;letter-spacing:0.3px;text-transform:uppercase;vertical-align:middle;float:left;">Privacy</span></div></div><script>__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: 'atatags-26942-704198',location: 310,formFactor: '001',label: {text: 'Advertisements',},creative: {reportAd: {text: 'Report this ad',},privacySettings: {text: 'Privacy',onClick: function() { window.__tcfapi && window.__tcfapi( 'showUi' ); },}}});});</script></div><p>Its almost 2.5-3 times slower but it gives us five greeks. A naive finite-difference approximation would costs us at least 6 calculations and would be only an numerical approximation. Here we have ‘exact’ derivates.</p>
<h4>Second order greeks in Pytorch</h4>
<p>The 2nd order greeks are a bit tricky and not so straight-forward. We need<br>
to create a computational graph of the gradient. We use the function <code>.grad()</code> from the autograd module. And can then call the backward method on it.</p>
<div><div id="highlighter_5053" class="syntaxhighlighter  python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">gradient </code><code class="python keyword">=</code> <code class="python plain">torch.autograd.grad(npv_pytorch, S_0, create_graph</code><code class="python keyword">=</code><code class="python color1">True</code><code class="python plain">)</code></div><div class="line number2 index1 alt1"><code class="python plain">delta, </code><code class="python keyword">=</code>&nbsp; <code class="python plain">gradient</code></div><div class="line number3 index2 alt2"><code class="python plain">delta.backward(retain_graph</code><code class="python keyword">=</code><code class="python color1">True</code><code class="python plain">)</code></div><div class="line number4 index3 alt1"><code class="python functions">print</code><code class="python plain">(</code><code class="python string">'Delta: '</code><code class="python plain">, delta)</code></div><div class="line number5 index4 alt2"><code class="python functions">print</code><code class="python plain">(</code><code class="python string">'Gamma'</code><code class="python plain">, S_0.grad)</code></div></div></td></tr></tbody></table></div></div>
<p><img data-attachment-id="524" data-permalink="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/gamma_plot/" data-orig-file="https://ipythonquant.files.wordpress.com/2018/11/gamma_plot.png" data-orig-size="5100,3000" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="gamma_plot" data-image-description="" data-image-caption="" data-medium-file="https://ipythonquant.files.wordpress.com/2018/11/gamma_plot.png?w=300" data-large-file="https://ipythonquant.files.wordpress.com/2018/11/gamma_plot.png?w=656" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/gamma_plot.png" alt="gamma_plot.png" class="alignnone size-full wp-image-524" srcset="https://ipythonquant.files.wordpress.com/2018/11/gamma_plot.png?w=656 656w, https://ipythonquant.files.wordpress.com/2018/11/gamma_plot.png?w=1312 1312w, https://ipythonquant.files.wordpress.com/2018/11/gamma_plot.png?w=150 150w, https://ipythonquant.files.wordpress.com/2018/11/gamma_plot.png?w=300 300w, https://ipythonquant.files.wordpress.com/2018/11/gamma_plot.png?w=768 768w, https://ipythonquant.files.wordpress.com/2018/11/gamma_plot.png?w=1024 1024w" sizes="(max-width: 656px) 100vw, 656px"></p>
<p>Now let’s recap the results from the TensorFlow implementation.</p>
<h3>TensorFlow implementation</h3>
<p>Using the same code as in the original notebook (but I removed the calculation of the 2nd order greeks. There is a bit of overhead for constructing the computational graph.</p>
<div><div id="highlighter_793057" class="syntaxhighlighter  python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">def</code> <code class="python plain">blackScholes_tf_pricer():</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># Build the static computational graph</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">S </code><code class="python keyword">=</code> <code class="python plain">tf.placeholder(tf.float32)</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">K </code><code class="python keyword">=</code> <code class="python plain">tf.placeholder(tf.float32)</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt </code><code class="python keyword">=</code> <code class="python plain">tf.placeholder(tf.float32)</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sigma </code><code class="python keyword">=</code> <code class="python plain">tf.placeholder(tf.float32)</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r </code><code class="python keyword">=</code> <code class="python plain">tf.placeholder(tf.float32)</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">Phi </code><code class="python keyword">=</code> <code class="python plain">tf.distributions.Normal(</code><code class="python value">0.</code><code class="python plain">,</code><code class="python value">1.</code><code class="python plain">).cdf</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">d_1 </code><code class="python keyword">=</code> <code class="python plain">(tf.log(S </code><code class="python keyword">/</code> <code class="python plain">K) </code><code class="python keyword">+</code> <code class="python plain">(r</code><code class="python keyword">+</code><code class="python plain">sigma</code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python value">2</code><code class="python keyword">/</code><code class="python value">2</code><code class="python plain">)</code><code class="python keyword">*</code><code class="python plain">dt) </code><code class="python keyword">/</code> <code class="python plain">(sigma</code><code class="python keyword">*</code><code class="python plain">tf.sqrt(dt))</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">d_2 </code><code class="python keyword">=</code> <code class="python plain">d_1 </code><code class="python keyword">-</code> <code class="python plain">sigma</code><code class="python keyword">*</code><code class="python plain">tf.sqrt(dt)</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">npv </code><code class="python keyword">=</code>&nbsp; <code class="python plain">S</code><code class="python keyword">*</code><code class="python plain">Phi(d_1) </code><code class="python keyword">-</code> <code class="python plain">K</code><code class="python keyword">*</code><code class="python plain">tf.exp(</code><code class="python keyword">-</code><code class="python plain">r</code><code class="python keyword">*</code><code class="python plain">dt)</code><code class="python keyword">*</code><code class="python plain">Phi(d_2)</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">greeks </code><code class="python keyword">=</code> <code class="python plain">tf.gradients(npv, [S, sigma, r, K, dt])</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python plain">execute_graph(S_0, strike, time_to_expiry, implied_vol, riskfree_rate):</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">with tf.Session() as sess:</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res </code><code class="python keyword">=</code> <code class="python plain">sess.run([npv, greeks], </code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">{</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">S: S_0,</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">K : strike,</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r : riskfree_rate,</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sigma: implied_vol,</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt: time_to_expiry})</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">res</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">execute_graph </code></div></div></td></tr></tbody></table></div></div>
<p><img data-attachment-id="525" data-permalink="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/screenshot-2018-11-18-at-16-48-52/" data-orig-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-48-52.png" data-orig-size="1286,360" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screenshot 2018-11-18 at 16.48.52" data-image-description="" data-image-caption="" data-medium-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-48-52.png?w=300" data-large-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-48-52.png?w=656" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/screenshot-2018-11-18-at-16-48-52.png" alt="Screenshot 2018-11-18 at 16.48.52.png" class="alignnone size-full wp-image-525" srcset="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-48-52.png?w=656 656w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-48-52.png?w=150 150w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-48-52.png?w=300 300w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-48-52.png?w=768 768w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-48-52.png?w=1024 1024w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-16-48-52.png 1286w" sizes="(max-width: 656px) 100vw, 656px"></p>
<div class="wordads-ad-wrapper" style="display: inherit;"><div id="atatags-26942-81677" data-adtags-width="655" style="display:block;height:272px;margin:0 auto;overflow:hidden;padding:0;width:300px;"><div style="font:10px &#39;Open Sans&#39;, Arial, sans-serif;height:12px;margin:0;padding:0;text-align:left;">Advertisements</div><div style="height:250px;width:300px;" class="ata-slot-container-wrapper">
                <div style="height:100%;width:100%;" class="ata-slot-container">
                    <div style="height:100%;margin:0;overflow:hidden;padding:0;position:relative;width:100%;" class="ata-frame-wrapper">
            <div class="user-feedback" style="position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden;background:#f1f1f1;white-space:nowrap;font-family:Helvetica, Arial, sans-serif;font-size:12px;line-height:12px;box-shadow:0px 1px 2px 0px inset #999;margin:0;display:none;table-layout:fixed;letter-spacing:0.2px;z-index:5000;padding:0;">
                <div style="color:#808080;font-size:10px;line-height:10px;text-align:center;margin:0;padding:0;position:absolute;top:4px;width:100%;">Powered by wordads.co</div>
                <div style="box-sizing:border-box;padding:5px;text-align:center;display:table-cell;vertical-align:middle;margin:0;width:100%;">
                    <div style="color:#404040;margin:8px 0 0 0;white-space:normal;display:none;text-align:center;padding:0;line-height:12px;" class="user-feedback__thank-message">
                        <div style="font-weight:bold;text-align:center;line-height:12px;">We've received your report.</div>
                        <br>
                        Thanks for your feedback!
                    </div>
                    <a class="user-feedback__reason" data-reason-id="1" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Seen too often</span>
                </div>
            </a><a class="user-feedback__reason" data-reason-id="2" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Not relevant</span>
                </div>
            </a><a class="user-feedback__reason" data-reason-id="3" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Offensive</span>
                </div>
            </a><a class="user-feedback__reason" data-reason-id="4" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Broken</span>
                </div>
            </a>
                </div>
                
            </div>
        
                        <iframe id="atatags-26942-81677_iframe" frameborder="0" scrolling="no" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(13).html" style="border:none;height:250px;margin:0;overflow:hidden;width:300px;" class="ata-frame"></iframe>
                    </div>
                </div>
            </div><div id="atatags-26942-81677__controls" class="ata-controls" style="height:10px;line-height:10px;margin:0;padding:0;text-align:right;width:300px;"><span id="atatags-26942-81677__complain-btn" class="ata-controls__complain-btn" style="color:#c8c7cc;cursor:pointer;font-family:Verdana, sans-serif;font-size:6px;letter-spacing:0.3px;text-transform:uppercase;vertical-align:middle;float:right;">Report this ad</span><span id="atatags-26942-81677__privacy-btn" class="ata-controls__privacy-btn" style="color:#c8c7cc;cursor:pointer;font-family:Verdana, sans-serif;font-size:6px;letter-spacing:0.3px;text-transform:uppercase;vertical-align:middle;float:left;">Privacy</span></div></div><script>__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: 'atatags-26942-81677',location: 310,formFactor: '001',label: {text: 'Advertisements',},creative: {reportAd: {text: 'Report this ad',},privacySettings: {text: 'Privacy',onClick: function() { window.__tcfapi && window.__tcfapi( 'showUi' ); },}}});});</script></div><p>We are roughly factor 1000 times slower in TensorFlow. Maybe my implementation is just bad. Any feedback how to improve it would be very appreciated.</p>
<p><strong>First Observation</strong></p>
<p>So if anyone has already some pricing routines in Python using Numpy it seems to be much easier to port them to PyTorch instead to TensorFlow. And porting the code wouldn’t have any significant negative impacts on the speed.</p>
<p>Now we want to come to the core of this tutorial.</p>
<h2>Monte Carlo Pricing for Single Barrier Option</h2>
<p>Our example option is a down-and-out barrier with</p>
<p>Maturtiy: 2 year<br>
Spot : 100<br>
Strike : 110<br>
Volatility: 20.0 %<br>
Risk free rate: 3.0 %<br>
Barrier at 90</p>
<p>It’s the same option as in my previous post and we gonna use the same Numpy implementation</p>
<div><div id="highlighter_706616" class="syntaxhighlighter  python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">def</code> <code class="python plain">monte_carlo_down_out_py(S_0, strike, time_to_expiry, implied_vol, riskfree_rate, barrier, steps, samples):</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">stdnorm_random_variates </code><code class="python keyword">=</code> <code class="python plain">np.random.randn(samples, steps)</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">S </code><code class="python keyword">=</code> <code class="python plain">S_0</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">K </code><code class="python keyword">=</code> <code class="python plain">strike</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt </code><code class="python keyword">=</code> <code class="python plain">time_to_expiry </code><code class="python keyword">/</code> <code class="python plain">stdnorm_random_variates.shape[</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sigma </code><code class="python keyword">=</code> <code class="python plain">implied_vol</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r </code><code class="python keyword">=</code> <code class="python plain">riskfree_rate</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">B </code><code class="python keyword">=</code> <code class="python plain">barrier</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># See Advanced Monte Carlo methods for barrier and related exotic options by Emmanuel Gobet</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">B_shift </code><code class="python keyword">=</code> <code class="python plain">B</code><code class="python keyword">*</code><code class="python plain">np.exp(</code><code class="python value">0.5826</code><code class="python keyword">*</code><code class="python plain">sigma</code><code class="python keyword">*</code><code class="python plain">np.sqrt(dt))</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">S_T </code><code class="python keyword">=</code> <code class="python plain">S </code><code class="python keyword">*</code> <code class="python plain">np.cumprod(np.exp((r</code><code class="python keyword">-</code><code class="python plain">sigma</code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python value">2</code><code class="python keyword">/</code><code class="python value">2</code><code class="python plain">)</code><code class="python keyword">*</code><code class="python plain">dt</code><code class="python keyword">+</code><code class="python plain">sigma</code><code class="python keyword">*</code><code class="python plain">np.sqrt(dt)</code><code class="python keyword">*</code><code class="python plain">stdnorm_random_variates), axis</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">non_touch </code><code class="python keyword">=</code> <code class="python plain">(np.</code><code class="python functions">min</code><code class="python plain">(S_T, axis</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">) &gt; B_shift)</code><code class="python keyword">*</code><code class="python value">1</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">call_payout </code><code class="python keyword">=</code> <code class="python plain">np.maximum(S_T[:,</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">] </code><code class="python keyword">-</code> <code class="python plain">K, </code><code class="python value">0</code><code class="python plain">)</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">npv </code><code class="python keyword">=</code> <code class="python plain">np.mean(non_touch </code><code class="python keyword">*</code> <code class="python plain">call_payout)</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">np.exp(</code><code class="python keyword">-</code><code class="python plain">time_to_expiry</code><code class="python keyword">*</code><code class="python plain">r)</code><code class="python keyword">*</code><code class="python plain">npv</code></div></div></td></tr></tbody></table></div></div>
<p>For a simulation with 100.000 paths and 1.000 time steps we need approximately 4.8 sec.</p>
<div class="wordads-ad-wrapper" style="display: inherit;"><div id="atatags-26942-288980" data-adtags-width="655"></div><script>__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: 'atatags-26942-288980',location: 310,formFactor: '001',label: {text: 'Advertisements',},creative: {reportAd: {text: 'Report this ad',},privacySettings: {text: 'Privacy',onClick: function() { window.__tcfapi && window.__tcfapi( 'showUi' ); },}}});});</script></div><p><img data-attachment-id="529" data-permalink="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/screenshot-2018-11-18-at-17-49-35/" data-orig-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-49-35.png" data-orig-size="1322,156" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screenshot 2018-11-18 at 17.49.35" data-image-description="" data-image-caption="" data-medium-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-49-35.png?w=300" data-large-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-49-35.png?w=656" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/screenshot-2018-11-18-at-17-49-35.png" alt="Screenshot 2018-11-18 at 17.49.35.png" class="alignnone size-full wp-image-529" srcset="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-49-35.png?w=656 656w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-49-35.png?w=1305 1305w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-49-35.png?w=150 150w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-49-35.png?w=300 300w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-49-35.png?w=768 768w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-49-35.png?w=1024 1024w" sizes="(max-width: 656px) 100vw, 656px"></p>
<p>And again the PyTorch implementation looks very familiar. We have to replace the random number generator and replace the numpy functions with torch functions. There are two cumberstones, there is no equivalent to <code>np.maximum</code>, so we have to mask the negative payoff ourself and set it to zero and we have to convert the boolean tensor into a float tensor.</p>
<div><div id="highlighter_1833" class="syntaxhighlighter  python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">def</code> <code class="python plain">monte_carlo_down_out_torch(S_0, strike, time_to_expiry, implied_vol, riskfree_rate, barrier, steps, samples):</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">stdnorm_random_variates </code><code class="python keyword">=</code> <code class="python plain">torch.distributions.Normal(</code><code class="python value">0</code><code class="python plain">,</code><code class="python value">1</code><code class="python plain">).sample((samples, steps))</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">S </code><code class="python keyword">=</code> <code class="python plain">S_0</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">K </code><code class="python keyword">=</code> <code class="python plain">strike</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt </code><code class="python keyword">=</code> <code class="python plain">time_to_expiry </code><code class="python keyword">/</code> <code class="python plain">stdnorm_random_variates.shape[</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sigma </code><code class="python keyword">=</code> <code class="python plain">implied_vol</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r </code><code class="python keyword">=</code> <code class="python plain">riskfree_rate</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">B </code><code class="python keyword">=</code> <code class="python plain">barrier</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># See Advanced Monte Carlo methods for barrier and related exotic options by Emmanuel Gobet</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">B_shift </code><code class="python keyword">=</code> <code class="python plain">B</code><code class="python keyword">*</code><code class="python plain">torch.exp(</code><code class="python value">0.5826</code><code class="python keyword">*</code><code class="python plain">sigma</code><code class="python keyword">*</code><code class="python plain">torch.sqrt(dt))</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">S_T </code><code class="python keyword">=</code> <code class="python plain">S </code><code class="python keyword">*</code> <code class="python plain">torch.cumprod(torch.exp((r</code><code class="python keyword">-</code><code class="python plain">sigma</code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python value">2</code><code class="python keyword">/</code><code class="python value">2</code><code class="python plain">)</code><code class="python keyword">*</code><code class="python plain">dt</code><code class="python keyword">+</code><code class="python plain">sigma</code><code class="python keyword">*</code><code class="python plain">torch.sqrt(dt)</code><code class="python keyword">*</code><code class="python plain">stdnorm_random_variates), dim</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">non_touch </code><code class="python keyword">=</code> <code class="python plain">torch.</code><code class="python functions">min</code><code class="python plain">(S_T, dim</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">)[</code><code class="python value">0</code><code class="python plain">] &gt; B_shift</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">call_payout </code><code class="python keyword">=</code> <code class="python plain">S_T[:,</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">] </code><code class="python keyword">-</code> <code class="python plain">K</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">call_payout[call_payout&lt;</code><code class="python value">0</code><code class="python plain">]</code><code class="python keyword">=</code><code class="python value">0</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">npv </code><code class="python keyword">=</code> <code class="python plain">torch.mean(non_touch.</code><code class="python functions">type</code><code class="python plain">(torch.FloatTensor) </code><code class="python keyword">*</code> <code class="python plain">call_payout)</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">torch.exp(</code><code class="python keyword">-</code><code class="python plain">time_to_expiry</code><code class="python keyword">*</code><code class="python plain">r)</code><code class="python keyword">*</code><code class="python plain">npv</code></div></div></td></tr></tbody></table></div></div>
<p>The Monte-Carlo Simulation including calculating the pathwise greeks take the same time as the pure NPV Monte-Carlo Simulation in Numpy.</p>
<p><img data-attachment-id="527" data-permalink="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/screenshot-2018-11-18-at-17-02-13/" data-orig-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-02-13.png" data-orig-size="1448,384" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screenshot 2018-11-18 at 17.02.13" data-image-description="" data-image-caption="" data-medium-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-02-13.png?w=300" data-large-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-02-13.png?w=656" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/screenshot-2018-11-18-at-17-02-13.png" alt="Screenshot 2018-11-18 at 17.02.13.png" class="alignnone size-full wp-image-527" srcset="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-02-13.png?w=656 656w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-02-13.png?w=1312 1312w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-02-13.png?w=150 150w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-02-13.png?w=300 300w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-02-13.png?w=768 768w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-02-13.png?w=1024 1024w" sizes="(max-width: 656px) 100vw, 656px"></p>
<div class="wordads-ad-wrapper" style="display: inherit;"><div id="atatags-26942-404514" data-adtags-width="655"></div><script>__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: 'atatags-26942-404514',location: 310,formFactor: '001',label: {text: 'Advertisements',},creative: {reportAd: {text: 'Report this ad',},privacySettings: {text: 'Privacy',onClick: function() { window.__tcfapi && window.__tcfapi( 'showUi' ); },}}});});</script></div><p><strong>Second Observation</strong></p>
<p>Running Monte-Carlo Simulations in PyTorch on a CPU seems to be the same speed as Numpy implementation (double duration but calculate also greeks in the same time).</p>
<p>Now we want to make things really fast and run it on a GPU.</p>
<h3>Monte-Carlo Simulation of Barrier Options on GPUs</h3>
<h4>GCP Setup of GPU computing</h4>
<p>Since I have no Nvidia GPU in my laptop we will run our experiment on Google Cloud Platform. You can easily signup for GCP and you can receive 300 USD free credit for 12 months. To use GPU computing you need to check in which zones GPUs are available. First time users need to request the GPU usage first, the approval takes usually less than 1 day. You can follow the tutorial here:<br>
<iframe src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/embed.html" allowtransparency="true" frameborder="0" title="Embedded story" width="656" height="364" style="display: block;max-width: 100%;min-width: 220px;padding: 0;position: static;visibility: visible;border-top-left-radius: 5px;border-top-right-radius: 5px;border-bottom-right-radius: 5px;border-bottom-left-radius: 5px;border-color: #eee #ddd #bbb;border-width: 1px;border-style: solid;box-shadow: rgba(0, 0, 0, 0.15) 0px 1px 3px;"></iframe></p>
<p>Just replace the step 8 with the AISE PyTorch NVidia GPU Notebook.</p>
<p>The costs for instance with a Nvidia K80 is less than 2 USD per hour, and our example notebook will run only a few minutes.</p>
<p>Once you the virtual machine is started you can connect directly to the Jupyter notebook server and work in your browser as it would run on our local machine.</p>
<p>In my GitHub repository there is a dedicated notebook <code>BarrierOptionGPU.ipynb</code> which we can upload to the server.</p>
<h4>Cuda Implementation of our Monte-Carlo Simulation</h4>
<p>Again we need only minimal changes to our code. We need to change the random number generator to run on the CUDA device <code>torch.cuda.FloatTensor(steps, samples).normal_()</code> and after casting our boolean tensor we need to move it to the GPU <code>non_touch = non_touch.type(torch.cuda.FloatTensor)</code> and we have to copy all our inputs to the GPU as well <code>torch.tensor([...],requires_grad=True, device='cuda')</code>.</p>
<div><div id="highlighter_263545" class="syntaxhighlighter  python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">def</code> <code class="python plain">monte_carlo_down_out_torch_cuda(S_0, strike, time_to_expiry, implied_vol, riskfree_rate, barrier, steps, samples):</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">stdnorm_random_variates </code><code class="python keyword">=</code> <code class="python plain">torch.cuda.FloatTensor(steps, samples).normal_()</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">S </code><code class="python keyword">=</code> <code class="python plain">S_0</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">K </code><code class="python keyword">=</code> <code class="python plain">strike</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt </code><code class="python keyword">=</code> <code class="python plain">time_to_expiry </code><code class="python keyword">/</code> <code class="python plain">stdnorm_random_variates.shape[</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sigma </code><code class="python keyword">=</code> <code class="python plain">implied_vol</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r </code><code class="python keyword">=</code> <code class="python plain">riskfree_rate</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">B </code><code class="python keyword">=</code> <code class="python plain">barrier</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># See Advanced Monte Carlo methods for barrier and related exotic options by Emmanuel Gobet</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">B_shift </code><code class="python keyword">=</code> <code class="python plain">B</code><code class="python keyword">*</code><code class="python plain">torch.exp(</code><code class="python value">0.5826</code><code class="python keyword">*</code><code class="python plain">sigma</code><code class="python keyword">*</code><code class="python plain">torch.sqrt(dt))</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">S_T </code><code class="python keyword">=</code> <code class="python plain">S </code><code class="python keyword">*</code> <code class="python plain">torch.cumprod(torch.exp((r</code><code class="python keyword">-</code><code class="python plain">sigma</code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python value">2</code><code class="python keyword">/</code><code class="python value">2</code><code class="python plain">)</code><code class="python keyword">*</code><code class="python plain">dt</code><code class="python keyword">+</code><code class="python plain">sigma</code><code class="python keyword">*</code><code class="python plain">torch.sqrt(dt)</code><code class="python keyword">*</code><code class="python plain">stdnorm_random_variates), dim</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">non_touch </code><code class="python keyword">=</code> <code class="python plain">torch.</code><code class="python functions">min</code><code class="python plain">(S_T, dim</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">)[</code><code class="python value">0</code><code class="python plain">] &gt; B_shift</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">non_touch </code><code class="python keyword">=</code> <code class="python plain">non_touch.</code><code class="python functions">type</code><code class="python plain">(torch.cuda.FloatTensor)</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">call_payout </code><code class="python keyword">=</code> <code class="python plain">S_T[:,</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">] </code><code class="python keyword">-</code> <code class="python plain">K</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">call_payout[call_payout&lt;</code><code class="python value">0</code><code class="python plain">]</code><code class="python keyword">=</code><code class="python value">0</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">npv </code><code class="python keyword">=</code> <code class="python plain">torch.mean(non_touch </code><code class="python keyword">*</code> <code class="python plain">call_payout)</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">torch.exp(</code><code class="python keyword">-</code><code class="python plain">time_to_expiry</code><code class="python keyword">*</code><code class="python plain">r)</code><code class="python keyword">*</code><code class="python plain">npv</code></div></div></td></tr></tbody></table></div></div>
<p><img data-attachment-id="528" data-permalink="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/screenshot-2018-11-18-at-17-21-42/" data-orig-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-21-42.png" data-orig-size="1496,384" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screenshot 2018-11-18 at 17.21.42" data-image-description="" data-image-caption="" data-medium-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-21-42.png?w=300" data-large-file="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-21-42.png?w=656" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/screenshot-2018-11-18-at-17-21-42.png" alt="Screenshot 2018-11-18 at 17.21.42.png" class="alignnone size-full wp-image-528" srcset="https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-21-42.png?w=656 656w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-21-42.png?w=1309 1309w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-21-42.png?w=150 150w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-21-42.png?w=300 300w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-21-42.png?w=768 768w, https://ipythonquant.files.wordpress.com/2018/11/screenshot-2018-11-18-at-17-21-42.png?w=1024 1024w" sizes="(max-width: 656px) 100vw, 656px"></p>
<div class="wordads-ad-wrapper" style="display: inherit;"><div id="atatags-26942-323421" data-adtags-width="655"></div><script>__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: 'atatags-26942-323421',location: 310,formFactor: '001',label: {text: 'Advertisements',},creative: {reportAd: {text: 'Report this ad',},privacySettings: {text: 'Privacy',onClick: function() { window.__tcfapi && window.__tcfapi( 'showUi' ); },}}});});</script></div><p>The pricing and greek calculation is 45 times faster than on CPUs.</p>
<h2>Conclusion</h2>
<p>Writing and coding this tutorial was great fun for me. PyTorch feels for me much easier and cleaner to use for writing pricing algorithm compared to TensorFlow, which maybe will change with TensorFlow 2.0 which is a major redesign. With PyTorch it’s very easy to implement Monte-Carlo Simulations with Adjoint Greeks and running the code on GPUs is seamless even without experience in  GPU code in C++. I wonder how fast a C++/CUDA implementation would be? Maybe something for future post.</p>
<p>So long…</p>
<div id="atatags-370373-64b4d68741f4e">
		<script type="text/javascript">
			__ATA.cmd.push(function() {
				__ATA.initVideoSlot('atatags-370373-64b4d68741f4e', {
					sectionId: '370373',
					format: 'inread'
				});
			});
		</script>
	</div>			<div id="atatags-26942-64b4d68741ffe" data-adtags-width="655"></div>
			
			<script>
				__ATA.cmd.push(function() {
					__ATA.initDynamicSlot({
						id: 'atatags-26942-64b4d68741ffe',
						location: 120,
						formFactor: '001',
						label: {
							text: 'Advertisements',
						},
						creative: {
							reportAd: {
								text: 'Report this ad',
							},
							privacySettings: {
								text: 'Privacy',
								onClick: function() { window.__tcfapi && window.__tcfapi( 'showUi' ); },
							}
						}
					});
				});
			</script><div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul data-sharing-events-added="true"><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-516" class="share-twitter sd-button share-icon" href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/?share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-516" class="share-facebook sd-button share-icon" href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/?share=facebook&amp;nb=1" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-516" class="share-linkedin sd-button share-icon" href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/?share=linkedin&amp;nb=1" target="_blank" title="Click to share on LinkedIn"><span>LinkedIn</span></a></li><li class="share-end"></li></ul></div></div></div><div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded" id="like-post-wrapper-88621851-516-64b4d68743106" data-src="//widgets.wp.com/likes/index.html?ver=20230309#blog_id=88621851&amp;post_id=516&amp;origin=ipythonquant.wordpress.com&amp;obj_id=88621851-516-64b4d68743106" data-name="like-post-frame-88621851-516-64b4d68743106" data-title="Like or Reblog"><h3 class="sd-title">Like this:</h3><div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px;"><span class="button"><span>Like</span></span> <span class="loading">Loading...</span></div><span class="sd-text-color"></span><a class="sd-link-color"></a></div>
<div id="jp-relatedposts" class="jp-relatedposts" style="display: block;">
	
<div class="jp-relatedposts-items jp-relatedposts-items-minimal jp-relatedposts-grid "><p class="jp-relatedposts-post jp-relatedposts-post0" data-post-id="351" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://ipythonquant.wordpress.com/2018/05/22/tensorflow-meets-quantitative-finance-pricing-exotic-options-with-monte-carlo-simulations-in-tensorflow/" title="TensorFlow meets Quantitative Finance: Pricing Exotic Options with Monte Carlo Simulations in&amp;nbsp;TensorFlow" data-origin="516" data-position="0">TensorFlow meets Quantitative Finance: Pricing Exotic Options with Monte Carlo Simulations in&nbsp;TensorFlow</a></span><time class="jp-relatedposts-post-date" datetime="22/05/2018" style="display: block;">22/05/2018</time><span class="jp-relatedposts-post-context">In "Allgemein"</span></p><p class="jp-relatedposts-post jp-relatedposts-post1" data-post-id="474" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://ipythonquant.wordpress.com/2018/11/11/fraud-detection-unsupervised-anomaly-detection-in-transactional-data-with-rnns-and-embeddings/" title="Fraud detection: Behavioural modeling and unsupervised anomaly detection  with deep&amp;nbsp;learning" data-origin="516" data-position="1">Fraud detection: Behavioural modeling and unsupervised anomaly detection  with deep&nbsp;learning</a></span><time class="jp-relatedposts-post-date" datetime="11/11/2018" style="display: block;">11/11/2018</time><span class="jp-relatedposts-post-context">In "Fraud Detection"</span></p><p class="jp-relatedposts-post jp-relatedposts-post2" data-post-id="357" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://ipythonquant.wordpress.com/2018/06/01/pricing-bermudan-options-in-tensorflow-learning-an-optimal-early-exercise-strategy/" title="Pricing Bermudan Options in TensorFlow &amp;#8211; Learning an optimal Early Exercise&amp;nbsp;Strategy" data-origin="516" data-position="2">Pricing Bermudan Options in TensorFlow – Learning an optimal Early Exercise&nbsp;Strategy</a></span><time class="jp-relatedposts-post-date" datetime="01/06/2018" style="display: block;">01/06/2018</time><span class="jp-relatedposts-post-context">In "Monte Carlo Simulation"</span></p></div></div></div>			</div><!-- .entry-content -->

	<footer class="entry-footer">
				<span class="cat-links">
			Posted in <a href="https://ipythonquant.wordpress.com/category/allgemein/" rel="category tag">Allgemein</a>		</span>
					</footer><!-- .entry-footer -->
</article><!-- #post-## -->

				<nav class="navigation post-navigation" role="navigation">
		<h1 class="screen-reader-text">Post navigation</h1>
		<div class="nav-links">
			<div class="nav-previous"><a href="https://ipythonquant.wordpress.com/2018/11/11/fraud-detection-unsupervised-anomaly-detection-in-transactional-data-with-rnns-and-embeddings/" rel="prev"><span class="meta-nav">&lt; Previous</span> Fraud detection: Behavioural modeling and unsupervised anomaly detection  with deep&nbsp;learning</a></div>		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
			
<div id="comments" class="comments-area">

	
	
	
		<div id="respond" class="comment-respond js">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://ipythonquant.wordpress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate=""><input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="05c1045780"><input type="hidden" name="_wp_http_referer" value="/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/">
<input type="hidden" name="hc_post_as" id="hc_post_as" value="guest">

<div class="comment-form-field comment-textarea">
	
	<div id="comment-form-comment"><textarea id="comment" name="comment" title="Enter your comment here..." placeholder="Enter your comment here..." style="overflow: hidden; overflow-wrap: break-word; resize: none; height: 38px;"></textarea></div>
</div>

		<div id="comment-form-identity" style="display: none;">
	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/#comment-form-guest" id="postas-guest" class="nascar-signin-link" title="Login via Guest">
									</a>
			</li>
			<li>
				<a href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/#comment-form-load-service:WordPress.com" id="postas-wordpress" class="nascar-signin-link" title="Login via WordPress.com">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#0087be" d="M12.158 12.786l-2.698 7.84c.806.236 1.657.365 2.54.365 1.047 0 2.05-.18 2.986-.51-.024-.037-.046-.078-.065-.123l-2.762-7.57zM3.008 12c0 3.56 2.07 6.634 5.068 8.092L3.788 8.342c-.5 1.117-.78 2.354-.78 3.658zm15.06-.454c0-1.112-.398-1.88-.74-2.48-.456-.74-.883-1.368-.883-2.11 0-.825.627-1.595 1.51-1.595.04 0 .078.006.116.008-1.598-1.464-3.73-2.36-6.07-2.36-3.14 0-5.904 1.613-7.512 4.053.21.008.41.012.58.012.94 0 2.395-.114 2.395-.114.484-.028.54.684.057.74 0 0-.487.058-1.03.086l3.275 9.74 1.968-5.902-1.4-3.838c-.485-.028-.944-.085-.944-.085-.486-.03-.43-.77.056-.742 0 0 1.484.114 2.368.114.94 0 2.397-.114 2.397-.114.486-.028.543.684.058.74 0 0-.488.058-1.03.086l3.25 9.665.897-2.997c.456-1.17.684-2.137.684-2.907zm1.82-3.86c.04.286.06.593.06.924 0 .912-.17 1.938-.683 3.22l-2.746 7.94c2.672-1.558 4.47-4.454 4.47-7.77 0-1.564-.4-3.033-1.1-4.314zM12 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10z"></path></g></svg>				</a>
			</li>
			<li>
				<a href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/#comment-form-load-service:Facebook" id="postas-facebook" class="nascar-signin-link" title="Login via Facebook">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#3B5998" d="M20.007 3H3.993C3.445 3 3 3.445 3 3.993v16.013c0 .55.445.994.993.994h8.62v-6.97H10.27V11.31h2.346V9.31c0-2.325 1.42-3.59 3.494-3.59.993 0 1.847.073 2.096.106v2.43h-1.438c-1.128 0-1.346.537-1.346 1.324v1.734h2.69l-.35 2.717h-2.34V21h4.587c.548 0 .993-.445.993-.993V3.993c0-.548-.445-.993-.993-.993z"></path></g></svg>				</a>
			</li>
		</ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/ad516503a11cd5ca435acc9bb6523536" srcset="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G 1x, https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=38&amp;d=identicon&amp;forcedefault=y&amp;r=G 1.5x, https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=50&amp;d=identicon&amp;forcedefault=y&amp;r=G 2x, https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=75&amp;d=identicon&amp;forcedefault=y&amp;r=G 3x, https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=100&amp;d=identicon&amp;forcedefault=y&amp;r=G 4x" alt="Gravatar" width="25" class="no-grav grav-hashed grav-hijack" id="grav-ad516503a11cd5ca435acc9bb6523536-0">
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email" value=""></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name <span class="required">(required)</span></label>
					<div class="comment-form-input"><input id="author" name="author" type="text" value=""></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="url" value=""></div>
				</div>
			</div>
			
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/ad516503a11cd5ca435acc9bb6523536" srcset="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G 1x, https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=38&amp;d=identicon&amp;forcedefault=y&amp;r=G 1.5x, https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=50&amp;d=identicon&amp;forcedefault=y&amp;r=G 2x, https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=75&amp;d=identicon&amp;forcedefault=y&amp;r=G 3x, https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=100&amp;d=identicon&amp;forcedefault=y&amp;r=G 4x" alt="WordPress.com Logo" width="25" class="no-grav grav-hashed grav-hijack" id="grav-ad516503a11cd5ca435acc9bb6523536-1">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="">
				<input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="">
				<input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="">
						<p class="comment-form-posting-as pa-wordpress">
			<strong></strong>
			You are commenting using your WordPress.com account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( &#39;wordpress&#39; );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#0087be" d="M12.158 12.786l-2.698 7.84c.806.236 1.657.365 2.54.365 1.047 0 2.05-.18 2.986-.51-.024-.037-.046-.078-.065-.123l-2.762-7.57zM3.008 12c0 3.56 2.07 6.634 5.068 8.092L3.788 8.342c-.5 1.117-.78 2.354-.78 3.658zm15.06-.454c0-1.112-.398-1.88-.74-2.48-.456-.74-.883-1.368-.883-2.11 0-.825.627-1.595 1.51-1.595.04 0 .078.006.116.008-1.598-1.464-3.73-2.36-6.07-2.36-3.14 0-5.904 1.613-7.512 4.053.21.008.41.012.58.012.94 0 2.395-.114 2.395-.114.484-.028.54.684.057.74 0 0-.487.058-1.03.086l3.275 9.74 1.968-5.902-1.4-3.838c-.485-.028-.944-.085-.944-.085-.486-.03-.43-.77.056-.742 0 0 1.484.114 2.368.114.94 0 2.397-.114 2.397-.114.486-.028.543.684.058.74 0 0-.488.058-1.03.086l3.25 9.665.897-2.997c.456-1.17.684-2.137.684-2.907zm1.82-3.86c.04.286.06.593.06.924 0 .912-.17 1.938-.683 3.22l-2.746 7.94c2.672-1.558 4.47-4.454 4.47-7.77 0-1.564-.4-3.033-1.1-4.314zM12 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10z"></path></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/" alt="Facebook photo" width="25" class="no-grav">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="">
				<input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="">
				<input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="">
						<p class="comment-form-posting-as pa-facebook">
			<strong></strong>
			You are commenting using your Facebook account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( &#39;facebook&#39; );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#3B5998" d="M20.007 3H3.993C3.445 3 3 3.445 3 3.993v16.013c0 .55.445.994.993.994h8.62v-6.97H10.27V11.31h2.346V9.31c0-2.325 1.42-3.59 3.494-3.59.993 0 1.847.073 2.096.106v2.43h-1.438c-1.128 0-1.346.537-1.346 1.324v1.734h2.69l-.35 2.717h-2.34V21h4.587c.548 0 .993-.445.993-.993V3.993c0-.548-.445-.993-.993-.993z"></path></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

</div>

<script type="text/javascript">
var highlander_expando_javascript = function () {

	function hide( sel ) {
		var el = document.querySelector( sel );
		if ( el ) {
			el.style.setProperty( 'display', 'none' );
		}
	}

	function show( sel ) {
		var el = document.querySelector( sel );
		if ( el ) {
			el.style.removeProperty( 'display' );
		}
	}

	var input = document.createElement( 'input' );
	var comment = document.querySelector( '#comment' );

	if ( input && comment && 'placeholder' in input ) {
		var label = document.querySelector( '.comment-textarea label' );
		if ( label ) {
			var text = label.textContent;
			label.parentNode.removeChild( label );
			comment.setAttribute( 'placeholder', text );
		}
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	hide( '#comment-form-identity' );
	hide( '#comment-form-subscribe' );
	hide( '#commentform .form-submit' );

	if ( comment ) {
		comment.style.height = '10px';

		var handler = function () {
			comment.style.height = HighlanderComments.initialHeight + 'px';
			show( '#comment-form-identity' );
			show( '#comment-form-subscribe' );
			show( '#commentform .form-submit' );
			HighlanderComments.resizeCallback();

			comment.removeEventListener( 'focus', handler );
		};

		comment.addEventListener( 'focus', handler );
	}
}

if ( document.readyState !== 'loading' ) {
	highlander_expando_javascript();
} else {
	document.addEventListener( 'DOMContentLoaded', highlander_expando_javascript );
}

</script>

<div id="comment-form-subscribe" style="display: none;">
	<p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;"> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p><p class="post-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto;"> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog" style="display: inline;">Notify me of new posts via email.</label></p></div>

	



<p class="form-submit" style="display: none;"><input name="submit" type="submit" id="comment-submit" class="submit button" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="516" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="56d28c4868"></p>
<input type="hidden" name="genseq" value="1689572999">
<p style="display: none !important;"><label>Δ<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="1689572999691"><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	<div style="clear: both"></div>
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->

	<div id="secondary" class="widget-area" role="complementary">
		<aside id="grofile-7" class="widget widget-grofile grofile"><h1 class="widget-title">About Me</h1>			<img src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/44d60a692860c3edca7e0ad596b4f5cd.png" class="grofile-thumbnail no-grav grav-hashed grav-hijack" alt="Matthias Groncki" id="grav-44d60a692860c3edca7e0ad596b4f5cd-0" originals="320" src-orig="https://1.gravatar.com/avatar/44d60a692860c3edca7e0ad596b4f5cd?s=320" scale="2">
			<div class="grofile-meta">
				<h4><a href="https://gravatar.com/mgroncki">Matthias Groncki</a></h4>
				<p>I am a quantitative developer with more than 10 years of experience in the field of quantitative risk management. Throughout my career, I have gained a strong background in derivatives pricing across multiple asset classes, honing my skills in market and model risk management. My proficiency in programming languages such as C++ and Python has been instrumental in developing robust and efficient risk management solutions, allowing me to leverage my quantitative expertise and technical acumen to drive actionable insights and mitigate potential risks. Additionally, I have gained valuable experience in non-financial and credit risk management, making me a versatile professional capable of tackling diverse risk challenges.</p>
			</div>

			
			<p><a href="https://gravatar.com/mgroncki" class="grofile-full-link">
				View Full Profile →			</a></p>

			</aside><aside id="jetpack_widget_social_icons-3" class="widget jetpack_widget_social_icons"><h1 class="widget-title">Follow me</h1>
			<ul class="jetpack-social-widget-list size-medium">

				
											<li class="jetpack-social-widget-item">
							<a href="http://www.linkedin.com/in/matthias-groncki-235490aa" target="_blank" rel="noopener noreferrer"><span class="screen-reader-text">LinkedIn</span><svg class="icon icon-linkedin" aria-hidden="true" role="presentation"> <use href="#icon-linkedin" xlink:href="#icon-linkedin"></use> </svg>							</a>
						</li>
					
				
			</ul>

			</aside><aside id="categories-4" class="widget widget_categories"><h1 class="widget-title">Categories</h1>
			<ul>
					<li class="cat-item cat-item-2710"><a href="https://ipythonquant.wordpress.com/category/allgemein/">Allgemein</a> (8)
</li>
	<li class="cat-item cat-item-168590"><a href="https://ipythonquant.wordpress.com/category/classification/">Classification</a> (5)
</li>
	<li class="cat-item cat-item-21818323"><a href="https://ipythonquant.wordpress.com/category/data-science/">Data Science</a> (5)
</li>
	<li class="cat-item cat-item-1131271"><a href="https://ipythonquant.wordpress.com/category/deep-learning/">Deep Learning</a> (3)
</li>
	<li class="cat-item cat-item-1326565"><a href="https://ipythonquant.wordpress.com/category/fraud-detection/">Fraud Detection</a> (6)
</li>
	<li class="cat-item cat-item-40978"><a href="https://ipythonquant.wordpress.com/category/machine-learning/">Machine Learning</a> (4)
</li>
	<li class="cat-item cat-item-65148"><a href="https://ipythonquant.wordpress.com/category/monte-carlo-simulation/">Monte Carlo Simulation</a> (7)
</li>
	<li class="cat-item cat-item-51999"><a href="https://ipythonquant.wordpress.com/category/pricing/">Pricing</a> (5)
</li>
	<li class="cat-item cat-item-832"><a href="https://ipythonquant.wordpress.com/category/python/">Python</a> (6)
</li>
	<li class="cat-item cat-item-23326"><a href="https://ipythonquant.wordpress.com/category/quantitative-finance/">Quantitative Finance</a> (3)
</li>
	<li class="cat-item cat-item-208818"><a href="https://ipythonquant.wordpress.com/category/quantlib/">QuantLib</a> (5)
</li>
	<li class="cat-item cat-item-417619185"><a href="https://ipythonquant.wordpress.com/category/tensorflow/">TensorFlow</a> (4)
</li>
	<li class="cat-item cat-item-4598337"><a href="https://ipythonquant.wordpress.com/category/xva/">xVA</a> (1)
</li>
			</ul>

			</aside><aside id="wp_tag_cloud-2" class="widget wp_widget_tag_cloud"><h1 class="widget-title">Keywords</h1><a href="https://ipythonquant.wordpress.com/tag/american-monte-carlo/" class="tag-cloud-link tag-link-499601960 tag-link-position-1" style="font-size: 10.964705882353pt;" aria-label="American Monte Carlo (2 items)">American Monte Carlo</a>
<a href="https://ipythonquant.wordpress.com/tag/automatic-differentiation/" class="tag-cloud-link tag-link-3188561 tag-link-position-2" style="font-size: 10.964705882353pt;" aria-label="Automatic Differentiation (2 items)">Automatic Differentiation</a>
<a href="https://ipythonquant.wordpress.com/tag/bermudan-swaption/" class="tag-cloud-link tag-link-346402656 tag-link-position-3" style="font-size: 10.964705882353pt;" aria-label="Bermudan Swaption (2 items)">Bermudan Swaption</a>
<a href="https://ipythonquant.wordpress.com/tag/classification/" class="tag-cloud-link tag-link-168590 tag-link-position-4" style="font-size: 12.941176470588pt;" aria-label="Classification (3 items)">Classification</a>
<a href="https://ipythonquant.wordpress.com/tag/counterparty-credit-risk/" class="tag-cloud-link tag-link-54129501 tag-link-position-5" style="font-size: 10.964705882353pt;" aria-label="Counterparty Credit Risk (2 items)">Counterparty Credit Risk</a>
<a href="https://ipythonquant.wordpress.com/tag/cva/" class="tag-cloud-link tag-link-1868054 tag-link-position-6" style="font-size: 10.964705882353pt;" aria-label="CVA (2 items)">CVA</a>
<a href="https://ipythonquant.wordpress.com/tag/data-science/" class="tag-cloud-link tag-link-21818323 tag-link-position-7" style="font-size: 12.941176470588pt;" aria-label="Data Science (3 items)">Data Science</a>
<a href="https://ipythonquant.wordpress.com/tag/deep-learning/" class="tag-cloud-link tag-link-1131271 tag-link-position-8" style="font-size: 14.588235294118pt;" aria-label="Deep Learning (4 items)">Deep Learning</a>
<a href="https://ipythonquant.wordpress.com/tag/dimension-reduction/" class="tag-cloud-link tag-link-9544986 tag-link-position-9" style="font-size: 8pt;" aria-label="Dimension reduction (1 item)">Dimension reduction</a>
<a href="https://ipythonquant.wordpress.com/tag/embedding/" class="tag-cloud-link tag-link-418180 tag-link-position-10" style="font-size: 8pt;" aria-label="Embedding (1 item)">Embedding</a>
<a href="https://ipythonquant.wordpress.com/tag/european-swaption/" class="tag-cloud-link tag-link-351699696 tag-link-position-11" style="font-size: 8pt;" aria-label="European Swaption (1 item)">European Swaption</a>
<a href="https://ipythonquant.wordpress.com/tag/exotic-options/" class="tag-cloud-link tag-link-6876198 tag-link-position-12" style="font-size: 10.964705882353pt;" aria-label="Exotic Options (2 items)">Exotic Options</a>
<a href="https://ipythonquant.wordpress.com/tag/expected-exposure/" class="tag-cloud-link tag-link-55611280 tag-link-position-13" style="font-size: 12.941176470588pt;" aria-label="Expected Exposure (3 items)">Expected Exposure</a>
<a href="https://ipythonquant.wordpress.com/tag/fraud/" class="tag-cloud-link tag-link-27320 tag-link-position-14" style="font-size: 10.964705882353pt;" aria-label="Fraud (2 items)">Fraud</a>
<a href="https://ipythonquant.wordpress.com/tag/fraud-detection/" class="tag-cloud-link tag-link-1326565 tag-link-position-15" style="font-size: 17.882352941176pt;" aria-label="Fraud Detection (7 items)">Fraud Detection</a>
<a href="https://ipythonquant.wordpress.com/tag/image-classification/" class="tag-cloud-link tag-link-8155030 tag-link-position-16" style="font-size: 8pt;" aria-label="Image Classification (1 item)">Image Classification</a>
<a href="https://ipythonquant.wordpress.com/tag/interest-rate-derivates/" class="tag-cloud-link tag-link-343686331 tag-link-position-17" style="font-size: 14.588235294118pt;" aria-label="Interest rate derivates (4 items)">Interest rate derivates</a>
<a href="https://ipythonquant.wordpress.com/tag/ipython/" class="tag-cloud-link tag-link-1688080 tag-link-position-18" style="font-size: 8pt;" aria-label="IPython (1 item)">IPython</a>
<a href="https://ipythonquant.wordpress.com/tag/keras/" class="tag-cloud-link tag-link-1772715 tag-link-position-19" style="font-size: 8pt;" aria-label="Keras (1 item)">Keras</a>
<a href="https://ipythonquant.wordpress.com/tag/knime/" class="tag-cloud-link tag-link-2793243 tag-link-position-20" style="font-size: 12.941176470588pt;" aria-label="KNIME (3 items)">KNIME</a>
<a href="https://ipythonquant.wordpress.com/tag/logistic-regression/" class="tag-cloud-link tag-link-4383675 tag-link-position-21" style="font-size: 8pt;" aria-label="Logistic Regression (1 item)">Logistic Regression</a>
<a href="https://ipythonquant.wordpress.com/tag/lstm/" class="tag-cloud-link tag-link-5183432 tag-link-position-22" style="font-size: 8pt;" aria-label="LSTM (1 item)">LSTM</a>
<a href="https://ipythonquant.wordpress.com/tag/machine-learning/" class="tag-cloud-link tag-link-40978 tag-link-position-23" style="font-size: 17.058823529412pt;" aria-label="Machine Learning (6 items)">Machine Learning</a>
<a href="https://ipythonquant.wordpress.com/tag/monte-carlo-simulation/" class="tag-cloud-link tag-link-65148 tag-link-position-24" style="font-size: 17.882352941176pt;" aria-label="Monte Carlo Simulation (7 items)">Monte Carlo Simulation</a>
<a href="https://ipythonquant.wordpress.com/tag/nlp/" class="tag-cloud-link tag-link-47433 tag-link-position-25" style="font-size: 8pt;" aria-label="NLP (1 item)">NLP</a>
<a href="https://ipythonquant.wordpress.com/tag/options/" class="tag-cloud-link tag-link-1654 tag-link-position-26" style="font-size: 10.964705882353pt;" aria-label="Options (2 items)">Options</a>
<a href="https://ipythonquant.wordpress.com/tag/ordinary-least-squares/" class="tag-cloud-link tag-link-6728605 tag-link-position-27" style="font-size: 10.964705882353pt;" aria-label="Ordinary least squares (2 items)">Ordinary least squares</a>
<a href="https://ipythonquant.wordpress.com/tag/pfe/" class="tag-cloud-link tag-link-212680 tag-link-position-28" style="font-size: 8pt;" aria-label="PFE (1 item)">PFE</a>
<a href="https://ipythonquant.wordpress.com/tag/pricing/" class="tag-cloud-link tag-link-51999 tag-link-position-29" style="font-size: 12.941176470588pt;" aria-label="Pricing (3 items)">Pricing</a>
<a href="https://ipythonquant.wordpress.com/tag/python/" class="tag-cloud-link tag-link-832 tag-link-position-30" style="font-size: 22pt;" aria-label="Python (13 items)">Python</a>
<a href="https://ipythonquant.wordpress.com/tag/pytorch/" class="tag-cloud-link tag-link-556315009 tag-link-position-31" style="font-size: 8pt;" aria-label="PyTorch (1 item)">PyTorch</a>
<a href="https://ipythonquant.wordpress.com/tag/quantlib/" class="tag-cloud-link tag-link-208818 tag-link-position-32" style="font-size: 17.058823529412pt;" aria-label="QuantLib (6 items)">QuantLib</a>
<a href="https://ipythonquant.wordpress.com/tag/recurrent-neural-network/" class="tag-cloud-link tag-link-21074029 tag-link-position-33" style="font-size: 8pt;" aria-label="Recurrent Neural Network (1 item)">Recurrent Neural Network</a>
<a href="https://ipythonquant.wordpress.com/tag/representation-learning/" class="tag-cloud-link tag-link-121288655 tag-link-position-34" style="font-size: 8pt;" aria-label="Representation Learning (1 item)">Representation Learning</a>
<a href="https://ipythonquant.wordpress.com/tag/scikit-learn/" class="tag-cloud-link tag-link-59016089 tag-link-position-35" style="font-size: 8pt;" aria-label="Scikit-Learn (1 item)">Scikit-Learn</a>
<a href="https://ipythonquant.wordpress.com/tag/short-rate-model/" class="tag-cloud-link tag-link-139228237 tag-link-position-36" style="font-size: 12.941176470588pt;" aria-label="Short rate model (3 items)">Short rate model</a>
<a href="https://ipythonquant.wordpress.com/tag/signature-verification/" class="tag-cloud-link tag-link-2133559 tag-link-position-37" style="font-size: 8pt;" aria-label="Signature Verification (1 item)">Signature Verification</a>
<a href="https://ipythonquant.wordpress.com/tag/swap/" class="tag-cloud-link tag-link-11089 tag-link-position-38" style="font-size: 8pt;" aria-label="Swap (1 item)">Swap</a>
<a href="https://ipythonquant.wordpress.com/tag/swaption/" class="tag-cloud-link tag-link-5393987 tag-link-position-39" style="font-size: 12.941176470588pt;" aria-label="Swaption (3 items)">Swaption</a>
<a href="https://ipythonquant.wordpress.com/tag/swig/" class="tag-cloud-link tag-link-640492 tag-link-position-40" style="font-size: 8pt;" aria-label="Swig (1 item)">Swig</a>
<a href="https://ipythonquant.wordpress.com/tag/tensorflow/" class="tag-cloud-link tag-link-417619185 tag-link-position-41" style="font-size: 14.588235294118pt;" aria-label="TensorFlow (4 items)">TensorFlow</a>
<a href="https://ipythonquant.wordpress.com/tag/transfer-learning/" class="tag-cloud-link tag-link-4600650 tag-link-position-42" style="font-size: 8pt;" aria-label="Transfer Learning (1 item)">Transfer Learning</a>
<a href="https://ipythonquant.wordpress.com/tag/unsupervised-learning/" class="tag-cloud-link tag-link-461277 tag-link-position-43" style="font-size: 8pt;" aria-label="Unsupervised Learning (1 item)">Unsupervised Learning</a></aside>
		<aside id="recent-posts-4" class="widget widget_recent_entries">
		<h1 class="widget-title">Last Posts</h1>
		<ul>
											<li>
					<a href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/" aria-current="page">Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in&nbsp;Python</a>
									</li>
											<li>
					<a href="https://ipythonquant.wordpress.com/2018/11/11/fraud-detection-unsupervised-anomaly-detection-in-transactional-data-with-rnns-and-embeddings/">Fraud detection: Behavioural modeling and unsupervised anomaly detection  with deep&nbsp;learning</a>
									</li>
											<li>
					<a href="https://ipythonquant.wordpress.com/2018/08/26/signature-verification-with-deep-learning-transfer-learning-using-keras-and-knime/">Signature Verification with deep learning / transfer learning using Keras and&nbsp;KNIME</a>
									</li>
											<li>
					<a href="https://ipythonquant.wordpress.com/2018/08/05/fooling-around-with-knime-contd-deep-learning/">Fooling Around with KNIME cont’d: Deep&nbsp;Learning</a>
									</li>
											<li>
					<a href="https://ipythonquant.wordpress.com/2018/07/19/fooling-around-with-knime/">Fooling around with&nbsp;KNIME</a>
									</li>
					</ul>

		</aside>			<div id="atatags-286348-64b4d68748074" data-adtags-width="234" style="display:block;height:622px;margin:0 auto;overflow:hidden;padding:0;width:120px;"><div style="font:10px &#39;Open Sans&#39;, Arial, sans-serif;height:12px;margin:0;padding:0;text-align:left;">Advertisements</div><div style="height:600px;width:120px;" class="ata-slot-container-wrapper">
                <div style="height:100%;width:100%;" class="ata-slot-container">
                    <div style="height:100%;margin:0;overflow:hidden;padding:0;position:relative;width:100%;" class="ata-frame-wrapper">
            <div class="user-feedback" style="position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden;background:#f1f1f1;white-space:nowrap;font-family:Helvetica, Arial, sans-serif;font-size:12px;line-height:12px;box-shadow:0px 1px 2px 0px inset #999;margin:0;display:none;table-layout:fixed;letter-spacing:0.2px;z-index:5000;padding:0;">
                <div style="color:#808080;font-size:10px;line-height:10px;text-align:center;margin:0;padding:0;position:absolute;top:4px;width:100%;">Powered by wordads.co</div>
                <div style="box-sizing:border-box;padding:5px;text-align:center;display:table-cell;vertical-align:middle;margin:0;width:100%;">
                    <div style="color:#404040;margin:8px 0 0 0;white-space:normal;display:none;text-align:center;padding:0;line-height:12px;" class="user-feedback__thank-message">
                        <div style="font-weight:bold;text-align:center;line-height:12px;">We've received your report.</div>
                        <br>
                        Thanks for your feedback!
                    </div>
                    <a class="user-feedback__reason" data-reason-id="1" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Seen too often</span>
                </div>
            </a><a class="user-feedback__reason" data-reason-id="2" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Not relevant</span>
                </div>
            </a><a class="user-feedback__reason" data-reason-id="3" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Offensive</span>
                </div>
            </a><a class="user-feedback__reason" data-reason-id="4" style="border-radius:2px;position:relative;overflow:hidden;display:block;padding:1px 5px;width:110px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Broken</span>
                </div>
            </a>
                </div>
                
            </div>
        
                        <iframe id="atatags-286348-64b4d68748074_iframe" frameborder="0" scrolling="no" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(14).html" style="border:none;height:600px;margin:0;overflow:hidden;width:120px;" class="ata-frame"></iframe>
                    </div>
                </div>
            </div><div id="atatags-286348-64b4d68748074__controls" class="ata-controls" style="height:10px;line-height:10px;margin:0;padding:0;text-align:right;width:120px;"><span id="atatags-286348-64b4d68748074__complain-btn" class="ata-controls__complain-btn" style="color:#c8c7cc;cursor:pointer;font-family:Verdana, sans-serif;font-size:6px;letter-spacing:0.3px;text-transform:uppercase;vertical-align:middle;float:right;">Report this ad</span><span id="atatags-286348-64b4d68748074__privacy-btn" class="ata-controls__privacy-btn" style="color:#c8c7cc;cursor:pointer;font-family:Verdana, sans-serif;font-size:6px;letter-spacing:0.3px;text-transform:uppercase;vertical-align:middle;float:left;">Privacy</span></div></div>
			
			<script>
				__ATA.cmd.push(function() {
					__ATA.initDynamicSlot({
						id: 'atatags-286348-64b4d68748074',
						location: 140,
						formFactor: '003',
						label: {
							text: 'Advertisements',
						},
						creative: {
							reportAd: {
								text: 'Report this ad',
							},
							privacySettings: {
								text: 'Privacy',
								onClick: function() { window.__tcfapi && window.__tcfapi( 'showUi' ); },
							}
						}
					});
				});
			</script>	</div><!-- #secondary -->

	</div><!-- #content -->

	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="site-info">
			<a href="https://wordpress.com/?ref=footer_custom_blog" rel="nofollow">Start a Blog at WordPress.com</a>.
			
					</div><!-- .site-info -->
			</footer><!-- #colophon -->
</div><!-- #page -->

<!--  -->
<script src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/gprofiles.js" id="grofiles-cards-js"></script>
<script id="wpgroho-js-extra">
var WPGroHo = {"my_hash":""};
</script>
<script crossorigin="anonymous" type="text/javascript" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/wpgroho.js"></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init( 'body', '#wp-admin-bar-my-account' );
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	</div>
<script id="highlander-comments-js-extra">
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","Logged in via %s":"Logged in via %s","Log out":"Log out","Email":"Email","Instantly":"Instantly","Daily":"Daily","Reply":"Reply","WordPress":"WordPress","Weekly":"Weekly","Notify me of new posts":"Notify me of new posts","Email me new posts":"Email me new posts","Email me new comments":"Email me new comments","Receive web and mobile notifications for posts on this site.":"Receive web and mobile notifications for posts on this site.","connectURL":"https:\/\/ipythonquant.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/ipythonquant.wordpress.com\/wp-login.php?action=logout&_wpnonce=315a7fee5c","homeURL":"https:\/\/ipythonquant.wordpress.com\/","postID":"516","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","Login to leave a reply.":"Login to leave a reply.","optional":"optional","Cancel":"Cancel","comment_registration":"","userIsLoggedIn":"","isJetpack":"","text_direction":"ltr"};
</script>
<script crossorigin="anonymous" type="text/javascript" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(6)"></script>
		<script type="text/javascript">
		( function() {
			function init() {
				document.body.addEventListener( 'is.post-load', function() {
					if ( typeof __ATA.insertInlineAds === 'function' ) {
						__ATA.insertInlineAds();
					}
				} );
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
		</script>		<!-- CCPA [start] -->
		<script type="text/javascript">
			( function () {

				var setupPrivacy = function() {

					// Minimal Mozilla Cookie library
					// https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie/Simple_document.cookie_framework
					var cookieLib = window.cookieLib = {getItem:function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,o,n,t,r,i){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var c="";if(n)switch(n.constructor){case Number:c=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:c="; expires="+n;break;case Date:c="; expires="+n.toUTCString()}return"rootDomain"!==r&&".rootDomain"!==r||(r=(".rootDomain"===r?".":"")+document.location.hostname.split(".").slice(-2).join(".")),document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(o)+c+(r?"; domain="+r:"")+(t?"; path="+t:"")+(i?"; secure":""),!0}};

					// Implement IAB USP API.
					window.__uspapi = function( command, version, callback ) {

						// Validate callback.
						if ( typeof callback !== 'function' ) {
							return;
						}

						// Validate the given command.
						if ( command !== 'getUSPData' || version !== 1 ) {
							callback( null, false );
							return;
						}

						// Check for GPC. If set, override any stored cookie.
						if ( navigator.globalPrivacyControl ) {
							callback( { version: 1, uspString: '1YYN' }, true );
							return;
						}

						// Check for cookie.
						var consent = cookieLib.getItem( 'usprivacy' );

						// Invalid cookie.
						if ( null === consent ) {
							callback( null, false );
							return;
						}

						// Everything checks out. Fire the provided callback with the consent data.
						callback( { version: 1, uspString: consent }, true );
					};

					// Initialization.
					document.addEventListener( 'DOMContentLoaded', function() {

						// Internal functions.
						var setDefaultOptInCookie = function() {
							var value = '1YNN';
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'usprivacy', value, 365 * 24 * 60 * 60, '/', domain );
						};

						var setDefaultOptOutCookie = function() {
							var value = '1YYN';
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'usprivacy', value, 24 * 60 * 60, '/', domain );
						};

						var setDefaultNotApplicableCookie = function() {
							var value = '1---';
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'usprivacy', value, 24 * 60 * 60, '/', domain );
						};

						var setCcpaAppliesCookie = function( applies ) {
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'ccpa_applies', applies, 24 * 60 * 60, '/', domain );
						}

						var maybeCallDoNotSellCallback = function() {
							if ( 'function' === typeof window.doNotSellCallback ) {
								return window.doNotSellCallback();
							}

							return false;
						}

						// Look for usprivacy cookie first.
						var usprivacyCookie = cookieLib.getItem( 'usprivacy' );

						// Found a usprivacy cookie.
						if ( null !== usprivacyCookie ) {

							// If the cookie indicates that CCPA does not apply, then bail.
							if ( '1---' === usprivacyCookie ) {
								return;
							}

							// CCPA applies, so call our callback to add Do Not Sell link to the page.
							maybeCallDoNotSellCallback();

							// We're all done, no more processing needed.
							return;
						}

						// We don't have a usprivacy cookie, so check to see if we have a CCPA applies cookie.
						var ccpaCookie = cookieLib.getItem( 'ccpa_applies' );

						// No CCPA applies cookie found, so we'll need to geolocate if this visitor is from California.
						// This needs to happen client side because we do not have region geo data in our $SERVER headers,
						// only country data -- therefore we can't vary cache on the region.
						if ( null === ccpaCookie ) {

							var request = new XMLHttpRequest();
							request.open( 'GET', 'https://public-api.wordpress.com/geo/', true );

							request.onreadystatechange = function () {
								if ( 4 === this.readyState ) {
									if ( 200 === this.status ) {

										// Got a geo response. Parse out the region data.
										var data = JSON.parse( this.response );
										var region      = data.region ? data.region.toLowerCase() : '';
										var ccpa_applies = ['california', 'colorado', 'connecticut', 'utah', 'virginia'].indexOf( region ) > -1;
										// Set CCPA applies cookie. This keeps us from having to make a geo request too frequently.
										setCcpaAppliesCookie( ccpa_applies );

										// Check if CCPA applies to set the proper usprivacy cookie.
										if ( ccpa_applies ) {
											if ( maybeCallDoNotSellCallback() ) {
												// Do Not Sell link added, so set default opt-in.
												setDefaultOptInCookie();
											} else {
												// Failed showing Do Not Sell link as required, so default to opt-OUT just to be safe.
												setDefaultOptOutCookie();
											}
										} else {
											// CCPA does not apply.
											setDefaultNotApplicableCookie();
										}
									} else {
										// Could not geo, so let's assume for now that CCPA applies to be safe.
										setCcpaAppliesCookie( true );
										if ( maybeCallDoNotSellCallback() ) {
											// Do Not Sell link added, so set default opt-in.
											setDefaultOptInCookie();
										} else {
											// Failed showing Do Not Sell link as required, so default to opt-OUT just to be safe.
											setDefaultOptOutCookie();
										}
									}
								}
							};

							// Send the geo request.
							request.send();
						} else {
							// We found a CCPA applies cookie.
							if ( ccpaCookie === 'true' ) {
								if ( maybeCallDoNotSellCallback() ) {
									// Do Not Sell link added, so set default opt-in.
									setDefaultOptInCookie();
								} else {
									// Failed showing Do Not Sell link as required, so default to opt-OUT just to be safe.
									setDefaultOptOutCookie();
								}
							} else {
								// CCPA does not apply.
								setDefaultNotApplicableCookie();
							}
						}
					} );
				};

				// Kickoff initialization.
				if ( window.defQueue && defQueue.isLOHP && defQueue.isLOHP === 2020 ) {
					defQueue.items.push( setupPrivacy );
				} else {
					setupPrivacy();
				}

			} )();
		</script>

		<!-- CCPA [end] -->
			<div id="actionbar" class="actnbr-pub-penscratch actnbr-has-follow">
		<ul>
								<li class="actnbr-btn actnbr-hidden">
								<a class="actnbr-action actnbr-actn-follow " href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/">
			<svg class="gridicon gridicons-reader-follow" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 16v2h-3v3h-2v-3h-3v-2h3v-3h2v3h3zM20 2v9h-4v3h-3v4H4c-1.1 0-2-.9-2-2V2h18zM8 13v-1H4v1h4zm3-3H4v1h7v-1zm0-2H4v1h7V8zm7-4H4v2h14V4z"></path></g></svg><span>Follow</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/">
			<svg class="gridicon gridicons-reader-following" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 13.482L15.508 21 12 17.4l1.412-1.388 2.106 2.188 6.094-6.094L23 13.482zm-7.455 1.862L20 10.89V2H2v14c0 1.1.9 2 2 2h4.538l4.913-4.832 2.095 2.176zM8 13H4v-1h4v1zm3-2H4v-1h7v1zm0-2H4V8h7v1zm7-3H4V4h14v2z"></path></g></svg><span>Following</span>
		</a>
							<div class="actnbr-popover tip tip-top-left actnbr-notice" id="follow-bubble">
							<div class="tip-arrow"></div>
							<div class="tip-inner actnbr-follow-bubble">
															<ul>
											<li class="actnbr-sitename actnbr-hidden">
			<a href="https://ipythonquant.wordpress.com/">
				<img alt="" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/wpcom-gray-white.png" srcset="https://s0.wp.com/i/logo/wpcom-gray-white.png 1x" class="avatar avatar-50" height="50" width="50">				Jupyter notebooks - a Swiss Army Knife for Quants			</a>
		</li>
										<form method="post" action="https://subscribe.wordpress.com/" accept-charset="utf-8" style="display: none;">
																						<div class="actnbr-follow-count">Join 35 other followers</div>
																					<div>
										<input type="email" name="email" placeholder="Enter your email address" class="actnbr-email-field" aria-label="Enter your email address">
										</div>
										<input type="hidden" name="action" value="subscribe">
										<input type="hidden" name="blog_id" value="88621851">
										<input type="hidden" name="source" value="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/">
										<input type="hidden" name="sub-type" value="actionbar-follow">
										<input type="hidden" id="_wpnonce" name="_wpnonce" value="9aa6e634b7">										<div class="actnbr-button-wrap">
											<button type="submit" value="Sign me up">
												Sign me up											</button>
										</div>
									</form>
									<li class="actnbr-login-nudge actnbr-hidden">
										<div>
											Already have a WordPress.com account? <a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fipythonquant.wordpress.com%2F2018%2F11%2F18%2Ffast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python%2F&amp;signup_flow=account">Log in now.</a>										</div>
									</li>
								</ul>
															</div>
						</div>
					</li>
							<li class="actnbr-ellipsis actnbr-hidden">
				<svg class="gridicon gridicons-ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M7 12c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm12-2c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-7 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2z"></path></g></svg>				<div class="actnbr-popover tip tip-top-left actnbr-more">
					<div class="tip-arrow"></div>
					<div class="tip-inner">
						<ul>
									<li class="actnbr-sitename actnbr-hidden">
			<a href="https://ipythonquant.wordpress.com/">
				<img alt="" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/wpcom-gray-white.png" srcset="https://s0.wp.com/i/logo/wpcom-gray-white.png 1x" class="avatar avatar-50" height="50" width="50">				Jupyter notebooks - a Swiss Army Knife for Quants			</a>
		</li>
								<li class="actnbr-folded-customize actnbr-hidden">
								<a href="https://ipythonquant.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fipythonquant.wordpress.com%2F2018%2F11%2F18%2Ffast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python%2F">
									<svg class="gridicon gridicons-customize" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M2 6c0-1.505.78-3.08 2-4 0 .845.69 2 2 2 1.657 0 3 1.343 3 3 0 .386-.08.752-.212 1.09.74.594 1.476 1.19 2.19 1.81L8.9 11.98c-.62-.716-1.214-1.454-1.807-2.192C6.753 9.92 6.387 10 6 10c-2.21 0-4-1.79-4-4zm12.152 6.848l1.34-1.34c.607.304 1.283.492 2.008.492 2.485 0 4.5-2.015 4.5-4.5 0-.725-.188-1.4-.493-2.007L18 9l-2-2 3.507-3.507C18.9 3.188 18.225 3 17.5 3 15.015 3 13 5.015 13 7.5c0 .725.188 1.4.493 2.007L3 20l2 2 6.848-6.848c1.885 1.928 3.874 3.753 5.977 5.45l1.425 1.148 1.5-1.5-1.15-1.425c-1.695-2.103-3.52-4.092-5.448-5.977z"></path></g></svg>									<span>Customize</span>
								</a>
							</li>
																<li class="actnbr-folded-follow actnbr-hidden">
												<a class="actnbr-action actnbr-actn-follow " href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/">
			<svg class="gridicon gridicons-reader-follow" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 16v2h-3v3h-2v-3h-3v-2h3v-3h2v3h3zM20 2v9h-4v3h-3v4H4c-1.1 0-2-.9-2-2V2h18zM8 13v-1H4v1h4zm3-3H4v1h7v-1zm0-2H4v1h7V8zm7-4H4v2h14V4z"></path></g></svg><span>Follow</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/">
			<svg class="gridicon gridicons-reader-following" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 13.482L15.508 21 12 17.4l1.412-1.388 2.106 2.188 6.094-6.094L23 13.482zm-7.455 1.862L20 10.89V2H2v14c0 1.1.9 2 2 2h4.538l4.913-4.832 2.095 2.176zM8 13H4v-1h4v1zm3-2H4v-1h7v1zm0-2H4V8h7v1zm7-3H4V4h14v2z"></path></g></svg><span>Following</span>
		</a>
										</li>
																	<li class="actnbr-signup actnbr-hidden"><a href="https://wordpress.com/start/">Sign up</a></li>
									<li class="actnbr-login actnbr-hidden"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fipythonquant.wordpress.com%2F2018%2F11%2F18%2Ffast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python%2F&amp;signup_flow=account">Log in</a></li>
																	<li class="actnbr-shortlink actnbr-hidden"><a href="https://wp.me/p5ZQAH-8k">Copy shortlink</a></li>
																	<li class="flb-report actnbr-hidden">
										<a href="http://en.wordpress.com/abuse/?report_url=https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/" target="_blank">
											Report this content										</a>
									</li>
																	<li class="actnbr-reader actnbr-hidden">
										<a href="https://wordpress.com/read/blogs/88621851/posts/516">
											View post in Reader										</a>
									</li>
																	<li class="actnbr-subs actnbr-hidden">
										<a href="https://subscribe.wordpress.com/">Manage subscriptions</a>
									</li>
																		<li class="actnbr-fold actnbr-hidden"><a href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/">Collapse this bar</a></li>
															</ul>
					</div>
				</div>
			</li>
		</ul>
	</div>
	
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20210915";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20220329";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions" itemscope="" itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"></path>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"></rect>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"></path>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"></rect>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"></path>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"></rect>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"></path>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>
							</span>
						</a>
												<a href="https://ipythonquant.wordpress.com/2018/11/18/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python/#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"></path>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea name="comment" class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea" id="jp-carousel-comment-form-comment-field" placeholder="Write a Comment..."></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field">
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field">
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field">
															</fieldset>
																											</div>
													<input type="submit" name="submit" class="jp-carousel-comment-form-button" id="jp-carousel-comment-form-button-submit" value="Post Comment">
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"></path>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/ipythonquant.wordpress.com\/2018\/11\/18\/fast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python\/":516};
	</script>
				<script crossorigin="anonymous" type="text/javascript" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(7)"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.head.appendChild( corecss );
		var themecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414i&amp;ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.head.appendChild( themecss );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	document.addEventListener( 'is.post-load', function () {
		SyntaxHighlighter.highlight();
	} );
</script>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-0-3" href="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(8)" type="text/css" media="all">
<link rel="stylesheet" id="gravatar-card-services-css" href="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/services.css" media="all">
<script crossorigin="anonymous" type="text/javascript" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/devicepx.js"></script>
<script src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/smart.js" id="smart-tag-lib-js"></script>
<script id="comment-like-js-extra">
var comment_like_text = {"loading":"Loading...","swipeUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/comment-likes\/js\/lib\/swipe.js?ver=20131008"};
</script>
<script crossorigin="anonymous" type="text/javascript" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(9)"></script>
<script src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/embed.js" id="medium-embed-js"></script>
<script id="jetpack-carousel-js-extra">
var jetpackSwiperLibraryPath = {"url":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/jetpack-plugin\/moon\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/ipythonquant.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"3080c5ef55","display_exif":"1","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/ipythonquant.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fipythonquant.wordpress.com%2F2018%2F11%2F18%2Ffast-monte-carlo-pricing-and-greeks-for-barrier-options-using-gpu-computing-on-google-cloud-platform-in-python%2F","blog_id":"88621851","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=88621851&v=wpcom&tz=2&user_id=0&subd=ipythonquant","is_public":"1"};
</script>
<script id="sharing-js-js-extra">
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
</script>
<script crossorigin="anonymous" type="text/javascript" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(10)"></script>
<script type="text/javascript">
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
</script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<iframe src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/master.html" scrolling="no" id="likes-master" name="likes-master" style="display:none;"></iframe>
	<div id="likes-other-gravatars">
		<div class="likes-text">
			<span>%d</span> bloggers like this:		</div>
		<ul class="wpl-avatars sd-like-gravatars"></ul>
	</div>

		<script src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/w.js" defer=""></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'88621851','blog_tz':'2','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'88621851','v':'wpcom','tz':'2','user_id':'0','post':'516','subd':'ipythonquant'}]);
_stq.push(['extra', {'crypt':'UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdWFnNncxc1tjZG9XVXhRaGp+TjRzYk8/WjlKTnQ1VGYyc18uUVElMHJvYXB1OH4sallTN2JHZHp3OC5lUUo/c05bYWpFekF2JmJmRTVlaWtaeE5QTDEtZ3ksd2xpNl8xTlJOfHxwZDd8X0pBWmViUWpaZVc5bD1pYkUyb35haGVNTD9MVTdbMDJLaC98MnA1WG1vYXE5L089PTlBWlJxaUJQRklfL11weFVuOF9jQ3xqQis4QTE0LDYrUmg4XVNKUzY5QX4lXVRTbXFCZnVXQ2lUMEFzQWYscklIZXAwYkpLcE1Cc1dYLj9EeC1oUVF0XVc9YWdaOC1vaTI9OVRzJXQsc2JSeGI9eWRbeHIwdCVLeVklL21CSTl+UHxfdlNGeDErTzFjWH42VF9vNEs5azRyeTJEUWxsZnBuSVdfMi45JlNYMUFFVEY5LUMuNyYlXQ=='}]);
_stq.push([ 'clickTrackerInit', '88621851', '516' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>

<iframe name="__tcfapiLocator" style="display: none;" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(15).html"></iframe><script>__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: 'atatags-26942-704198',location: 310,formFactor: '001',label: {text: 'Advertisements',},creative: {reportAd: {text: 'Report this ad',},privacySettings: {text: 'Privacy',onClick: function() { window.__tcfapi && window.__tcfapi( 'showUi' ); },}}});});</script><script>__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: 'atatags-26942-81677',location: 310,formFactor: '001',label: {text: 'Advertisements',},creative: {reportAd: {text: 'Report this ad',},privacySettings: {text: 'Privacy',onClick: function() { window.__tcfapi && window.__tcfapi( 'showUi' ); },}}});});</script><script>__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: 'atatags-26942-288980',location: 310,formFactor: '001',label: {text: 'Advertisements',},creative: {reportAd: {text: 'Report this ad',},privacySettings: {text: 'Privacy',onClick: function() { window.__tcfapi && window.__tcfapi( 'showUi' ); },}}});});</script><script>__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: 'atatags-26942-404514',location: 310,formFactor: '001',label: {text: 'Advertisements',},creative: {reportAd: {text: 'Report this ad',},privacySettings: {text: 'Privacy',onClick: function() { window.__tcfapi && window.__tcfapi( 'showUi' ); },}}});});</script><script>__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: 'atatags-26942-323421',location: 310,formFactor: '001',label: {text: 'Advertisements',},creative: {reportAd: {text: 'Report this ad',},privacySettings: {text: 'Privacy',onClick: function() { window.__tcfapi && window.__tcfapi( 'showUi' ); },}}});});</script><div class="comment-likes-overlay" style="display: none;"></div><div id="cmp-app-container"><div style="position: fixed; padding: 0px; bottom: 0px; left: 0px; right: 0px; z-index: 2147483646;"><iframe style="width: 100%; height: 242px; border: none; margin: 0px; display: flex;" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(16).html"></iframe></div></div><iframe src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/CookieSync.html" scrolling="no" frameborder="0" width="0" height="0" style="margin: 0px; padding: 0px; display: none; width: 0px; height: 0px; visibility: hidden;"></iframe><script>__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: 'atatags-26942-422605',location: 310,formFactor: '001',label: {text: 'Advertisements',},creative: {reportAd: {text: 'Report this ad',},privacySettings: {text: 'Privacy',onClick: function() { window.__tcfapi && window.__tcfapi( 'showUi' ); },}}});});</script><div class="bottom-sticky__ad-container bottom-sticky__ad-container_hidden" id="bottom-sticky__ad-container" style="">
            <div class="bottom-sticky__ad-close-btn"></div>
            <div id="bottom-sticky-ad" style="margin:0 auto;width:728px;"><div style="font:10px &#39;Open Sans&#39;, Arial, sans-serif;height:12px;margin:0;padding:0;text-align:left;">Advertisements</div><div style="height:90px;width:728px;" class="ata-slot-container-wrapper">
                <div style="height:100%;width:100%;" class="ata-slot-container">
                    <div style="height:100%;margin:0;overflow:hidden;padding:0;position:relative;width:100%;" class="ata-frame-wrapper">
            <div class="user-feedback" style="position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden;background:#f1f1f1;white-space:nowrap;font-family:Helvetica, Arial, sans-serif;font-size:12px;line-height:12px;box-shadow:0px 1px 2px 0px inset #999;margin:0;display:none;table-layout:fixed;letter-spacing:0.2px;z-index:5000;padding:0;">
                <div style="color:#808080;font-size:10px;line-height:10px;text-align:center;margin:0;padding:0;position:absolute;top:4px;width:100%;">Powered by wordads.co</div>
                <div style="box-sizing:border-box;padding:5px;text-align:center;display:table-cell;vertical-align:middle;margin:0;width:100%;">
                    <div style="color:#404040;margin:8px 0 0 0;white-space:normal;display:none;text-align:center;padding:0;line-height:12px;" class="user-feedback__thank-message">
                        <div style="font-weight:bold;text-align:center;line-height:12px;">We've received your report.</div>
                        <br>
                        Thanks for your feedback!
                    </div>
                    <a class="user-feedback__reason" data-reason-id="1" style="border-radius:2px;position:relative;overflow:hidden;display:inline-block;padding:1px 5px;width:95px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;margin-left:8px;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Seen too often</span>
                </div>
            </a><a class="user-feedback__reason" data-reason-id="2" style="border-radius:2px;position:relative;overflow:hidden;display:inline-block;padding:1px 5px;width:95px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;margin-left:8px;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Not relevant</span>
                </div>
            </a><a class="user-feedback__reason" data-reason-id="3" style="border-radius:2px;position:relative;overflow:hidden;display:inline-block;padding:1px 5px;width:95px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;margin-left:8px;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Offensive</span>
                </div>
            </a><a class="user-feedback__reason" data-reason-id="4" style="border-radius:2px;position:relative;overflow:hidden;display:inline-block;padding:1px 5px;width:95px;height:40px;border:none;background-color:#FFFFFF;cursor:pointer;box-sizing:border-box;margin:8px auto 0;color:#404040;font-weight:normal;text-decoration:none;margin-left:8px;;">
                <div style="width:100%;height:100%;display:table;text-align:center;margin:0;padding:0;">
                    <span style="vertical-align:middle;display:table-cell;text-align:center;line-height:14px;white-space:normal;margin:0;padding:0;">Broken</span>
                </div>
            </a>
                </div>
                
            </div>
        
                        <iframe id="bottom-sticky-ad_iframe" frameborder="0" scrolling="no" src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/saved_resource(17).html" style="border:none;height:90px;margin:0;overflow:hidden;width:728px;" class="ata-frame"></iframe>
                    </div>
                </div>
            </div><div id="bottom-sticky-ad__controls" class="ata-controls" style="height:10px;line-height:10px;margin:0;padding:0;text-align:right;width:728px;"><span id="bottom-sticky-ad__complain-btn" class="ata-controls__complain-btn" style="color:#c8c7cc;cursor:pointer;font-family:Verdana, sans-serif;font-size:6px;letter-spacing:0.3px;text-transform:uppercase;vertical-align:middle;float:right;">Report this ad</span><span id="bottom-sticky-ad__privacy-btn" class="ata-controls__privacy-btn" style="color:#c8c7cc;cursor:pointer;font-family:Verdana, sans-serif;font-size:6px;letter-spacing:0.3px;text-transform:uppercase;vertical-align:middle;float:left;">Privacy</span></div></div>
        </div><style>.bottom-sticky__ad-container {
    background: #f1f1f1;
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    transform: translate(0,0);
    transition: transform .2s ease-in-out;
    user-select: none;
    padding-top: 10px;
    z-index: 49999;         /* AUTOMATTIC-2205 - because cookie consent banner has 50000 z-index */
}
.bottom-sticky__ad-container_hidden {
    visibility: hidden;
    transform: translate(0,1000px);
}
.bottom-sticky__ad-close-btn {
    width: 20px;
    height: 20px;
    position: absolute;
    box-sizing: content-box;
    border: 2px solid #9d9d9d;
    right: 2px;
    top: -14px;
    border-radius: 50%;
    background-color: #fff;
    cursor: pointer;
    overflow: hidden;
    background-size: 12px;
    background-repeat: no-repeat;
    background-position: center;
    background-image: url("data:image/svg+xml,%3Csvg width='24' height='24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath stroke-width='4' stroke='%239d9d9d' d='M0 0l24 24M0 24L24 0'/%3E%3C/svg%3E");
}
.bottom-sticky__ad-container .adtags-button {
    color: #000;
}</style><style>.ata-controls__complain-btn:hover,
.ata-controls__privacy-btn:hover {
    color: #666666 !important;
}
.ata-controls__complain-btn:active,
.ata-controls__privacy-btn:active {
    color: #5ac8fa !important;
}
.ata-controls__complain-btn_clicked,
.ata-controls__complain-btn_clicked:hover,
.ata-controls__complain-btn_clicked:active {
    color: #000 !important;
    cursor: default !important;
}
.ata-frame-wrapper {
    overflow: hidden;
    position: relative;
}
</style><script src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/actionbar.js" defer=""></script><style>.user-feedback__reason:hover {
    color: #000 !important;
}
.user-feedback__slider:hover {
    background-color: rgba(0,0,0,0.6) !important;
    border: none !important;
}</style><style>img#wpstats {
			position: absolute !important;
			clip: rect(0, 0, 0, 0);
			padding: 0 !important;
			border: 0 !important;
			height: 0 !important;
			width: 0 !important;
			overflow: hidden;
		}</style><img src="./Fast Monte-Carlo Pricing and Greeks for Barrier Options using GPU computing on Google Cloud Platform in Python _ Jupyter notebooks – a Swiss Army Knife for Quants_files/g.gif" alt="" id="wpstats" scale="0"><style>.user-feedback__reason:hover {
    color: #000 !important;
}
.user-feedback__slider:hover {
    background-color: rgba(0,0,0,0.6) !important;
    border: none !important;
}</style><style>.user-feedback__reason:hover {
    color: #000 !important;
}
.user-feedback__slider:hover {
    background-color: rgba(0,0,0,0.6) !important;
    border: none !important;
}</style><style>.user-feedback__reason:hover {
    color: #000 !important;
}
.user-feedback__slider:hover {
    background-color: rgba(0,0,0,0.6) !important;
    border: none !important;
}</style><style>.user-feedback__reason:hover {
    color: #000 !important;
}
.user-feedback__slider:hover {
    background-color: rgba(0,0,0,0.6) !important;
    border: none !important;
}</style></body></html>